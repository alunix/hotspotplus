var _0x5ad5=['Y3JlYXRlTG9nZ2Vy','b2JzZXJ2ZQ==','YWZ0ZXIgc2F2ZQ==','aW5zdGFuY2U=','cG9zdA==','ZGF0YQ==','c2VhcmNoTmV0Zmxvdw==','c2VhcmNo','cmVtb3RlTWV0aG9k','c2VhcmNoRG5z','U2VhcmNoIERucw==','cmVwb3J0','c3RyaW5n','bnVtYmVy','dXNlcm5hbWU=','ZG9tYWlu','bGltaXQ=','c2tpcA==','c29ydA==','b3B0aW9ucw==','b2JqZWN0','b3B0aW9uc0Zyb21SZXF1ZXN0','Z2V0','c2VhcmNoV2ViUHJveHk=','U2VhcmNoIFdlYlByb3h5','dHlwZQ==','YnVzaW5lc3NJZA==','ZGVwYXJ0bWVudHM=','ZnJvbQ==','dXJs','UkVQT1JUX1NFUlZJQ0VfVVJM','L2FwaS8=','bW9kZWxz','QmlnRmlsZQ==','L3NlYXJjaA==','ZXhjZWw=','bm93','Lnhsc3g=','cmVwb3J0cw==','dXBsb2FkU3RyZWFt','cGlwZQ==','U2VhcmNoIE5ldGZsb3c=','c3JjQWRkcmVzcw==','c3JjUG9ydA==','ZHN0QWRkcmVzcw==','ZHN0UG9ydA==','e30uY29uc3RydWN0b3IoInJldHVybiB0aGlzIikoICk=','Y29uc29sZQ==','d2Fybg==','ZGVidWc=','aW5mbw==','ZXJyb3I=','ZXhjZXB0aW9u','dHJhY2U=','bG9n','Li4vLi4vc2VydmVyL21vZHVsZXMvbG9nZ2Vy','Li4vLi4vc2VydmVyL3NlcnZlcg==','Li4vLi4vc2VydmVyL21vZHVsZXMvdXRpbGl0eQ==','Li4vLi4vc2VydmVyL21vZHVsZXMvaHR0cENsaWVudA==','cGF0aA==','YXhpb3M=','dXRpbA==','ZW52','aW52YWxpZCBSRVBPUlRfU0VSVklDRV9VUkw='];(function(_0x15e6fe,_0x1a5c39){var _0x34894d=function(_0x32eec2){while(--_0x32eec2){_0x15e6fe['push'](_0x15e6fe['shift']());}};var _0x9d45c7=function(){var _0x2968f0={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x569f93,_0x517861,_0xd042ca,_0x3f968d){_0x3f968d=_0x3f968d||{};var _0x35238d=_0x517861+'='+_0xd042ca;var _0x7c6b8=0x0;for(var _0x7c6b8=0x0,_0x37ddf8=_0x569f93['length'];_0x7c6b8<_0x37ddf8;_0x7c6b8++){var _0x401457=_0x569f93[_0x7c6b8];_0x35238d+=';\x20'+_0x401457;var _0x2b12df=_0x569f93[_0x401457];_0x569f93['push'](_0x2b12df);_0x37ddf8=_0x569f93['length'];if(_0x2b12df!==!![]){_0x35238d+='='+_0x2b12df;}}_0x3f968d['cookie']=_0x35238d;},'removeCookie':function(){return'dev';},'getCookie':function(_0x9b457,_0x3d7335){_0x9b457=_0x9b457||function(_0x351315){return _0x351315;};var _0x1e98c3=_0x9b457(new RegExp('(?:^|;\x20)'+_0x3d7335['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x1c5113=function(_0x4da2f3,_0x182f43){_0x4da2f3(++_0x182f43);};_0x1c5113(_0x34894d,_0x1a5c39);return _0x1e98c3?decodeURIComponent(_0x1e98c3[0x1]):undefined;}};var _0x589bc3=function(){var _0xd8c6ea=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0xd8c6ea['test'](_0x2968f0['removeCookie']['toString']());};_0x2968f0['updateCookie']=_0x589bc3;var _0x519a26='';var _0x14f2a0=_0x2968f0['updateCookie']();if(!_0x14f2a0){_0x2968f0['setCookie'](['*'],'counter',0x1);}else if(_0x14f2a0){_0x519a26=_0x2968f0['getCookie'](null,'counter');}else{_0x2968f0['removeCookie']();}};_0x9d45c7();}(_0x5ad5,0xee));var _0x55ad=function(_0x22496a,_0x3da134){_0x22496a=_0x22496a-0x0;var _0x4312b4=_0x5ad5[_0x22496a];if(_0x55ad['initialized']===undefined){(function(){var _0x551cbe;try{var _0x5e566b=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x551cbe=_0x5e566b();}catch(_0x4a49f3){_0x551cbe=window;}var _0x389ab1='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x551cbe['atob']||(_0x551cbe['atob']=function(_0x59bd0a){var _0x3be7cc=String(_0x59bd0a)['replace'](/=+$/,'');for(var _0x291068=0x0,_0x48c6bc,_0x50121e,_0x50e8b7=0x0,_0x1af04c='';_0x50121e=_0x3be7cc['charAt'](_0x50e8b7++);~_0x50121e&&(_0x48c6bc=_0x291068%0x4?_0x48c6bc*0x40+_0x50121e:_0x50121e,_0x291068++%0x4)?_0x1af04c+=String['fromCharCode'](0xff&_0x48c6bc>>(-0x2*_0x291068&0x6)):0x0){_0x50121e=_0x389ab1['indexOf'](_0x50121e);}return _0x1af04c;});}());_0x55ad['base64DecodeUnicode']=function(_0x1d7c08){var _0x3b272b=atob(_0x1d7c08);var _0x2caf0a=[];for(var _0x1bcf4c=0x0,_0x2f8809=_0x3b272b['length'];_0x1bcf4c<_0x2f8809;_0x1bcf4c++){_0x2caf0a+='%'+('00'+_0x3b272b['charCodeAt'](_0x1bcf4c)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x2caf0a);};_0x55ad['data']={};_0x55ad['initialized']=!![];}var _0x5f45de=_0x55ad['data'][_0x22496a];if(_0x5f45de===undefined){var _0x3f0d69=function(_0xb58de8){this['rc4Bytes']=_0xb58de8;this['states']=[0x1,0x0,0x0];this['newState']=function(){return'newState';};this['firstState']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*';this['secondState']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x3f0d69['prototype']['checkState']=function(){var _0xccf8b0=new RegExp(this['firstState']+this['secondState']);return this['runState'](_0xccf8b0['test'](this['newState']['toString']())?--this['states'][0x1]:--this['states'][0x0]);};_0x3f0d69['prototype']['runState']=function(_0x5d9c46){if(!Boolean(~_0x5d9c46)){return _0x5d9c46;}return this['getState'](this['rc4Bytes']);};_0x3f0d69['prototype']['getState']=function(_0x423624){for(var _0x2f9f71=0x0,_0x1295d0=this['states']['length'];_0x2f9f71<_0x1295d0;_0x2f9f71++){this['states']['push'](Math['round'](Math['random']()));_0x1295d0=this['states']['length'];}return _0x423624(this['states'][0x0]);};new _0x3f0d69(_0x55ad)['checkState']();_0x4312b4=_0x55ad['base64DecodeUnicode'](_0x4312b4);_0x55ad['data'][_0x22496a]=_0x4312b4;}else{_0x4312b4=_0x5f45de;}return _0x4312b4;};var _0x2a2d03=function(){var _0x45897b=!![];return function(_0x186e03,_0x27e0a8){var _0x533b70=_0x45897b?function(){if(_0x27e0a8){var _0x454e89=_0x27e0a8['apply'](_0x186e03,arguments);_0x27e0a8=null;return _0x454e89;}}:function(){};_0x45897b=![];return _0x533b70;};}();var _0x18733e=_0x2a2d03(this,function(){var _0x1ca90d=function(){return'\x64\x65\x76';},_0x11fd37=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x132cfd=function(){var _0x141566=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x141566['\x74\x65\x73\x74'](_0x1ca90d['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x337245=function(){var _0x2c1cd8=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x2c1cd8['\x74\x65\x73\x74'](_0x11fd37['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x296ec3=function(_0x4acf3){var _0x92d1c8=~-0x1>>0x1+0xff%0x0;if(_0x4acf3['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x92d1c8)){_0x26a35c(_0x4acf3);}};var _0x26a35c=function(_0x49435b){var _0x2725c5=~-0x4>>0x1+0xff%0x0;if(_0x49435b['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x2725c5){_0x296ec3(_0x49435b);}};if(!_0x132cfd()){if(!_0x337245()){_0x296ec3('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x296ec3('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x296ec3('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x18733e();var _0x480548=function(){var _0x413405=!![];return function(_0x448c0f,_0x31bad5){var _0x250a06=_0x413405?function(){if(_0x31bad5){var _0x4e4402=_0x31bad5['apply'](_0x448c0f,arguments);_0x31bad5=null;return _0x4e4402;}}:function(){};_0x413405=![];return _0x250a06;};}();var _0x5aa07a=_0x480548(this,function(){var _0xad155e=function(){};var _0x56f578;try{var _0x25d7a1=Function('return\x20(function()\x20'+_0x55ad('0x0')+');');_0x56f578=_0x25d7a1();}catch(_0x3b5265){_0x56f578=window;}if(!_0x56f578[_0x55ad('0x1')]){_0x56f578[_0x55ad('0x1')]=function(_0x270e8a){var _0x54f645={};_0x54f645['log']=_0x270e8a;_0x54f645[_0x55ad('0x2')]=_0x270e8a;_0x54f645[_0x55ad('0x3')]=_0x270e8a;_0x54f645[_0x55ad('0x4')]=_0x270e8a;_0x54f645[_0x55ad('0x5')]=_0x270e8a;_0x54f645[_0x55ad('0x6')]=_0x270e8a;_0x54f645[_0x55ad('0x7')]=_0x270e8a;return _0x54f645;}(_0xad155e);}else{_0x56f578[_0x55ad('0x1')][_0x55ad('0x8')]=_0xad155e;_0x56f578[_0x55ad('0x1')]['warn']=_0xad155e;_0x56f578[_0x55ad('0x1')][_0x55ad('0x3')]=_0xad155e;_0x56f578[_0x55ad('0x1')][_0x55ad('0x4')]=_0xad155e;_0x56f578['console'][_0x55ad('0x5')]=_0xad155e;_0x56f578[_0x55ad('0x1')][_0x55ad('0x6')]=_0xad155e;_0x56f578[_0x55ad('0x1')][_0x55ad('0x7')]=_0xad155e;}});_0x5aa07a();'use strict';const config=require('../../server/modules/config');var logger=require(_0x55ad('0x9'));var app=require(_0x55ad('0xa'));var utility=require(_0x55ad('0xb'));var HttpClient=require(_0x55ad('0xc'));var Q=require('q');const fs=require('fs');const Path=require(_0x55ad('0xd'));const Axios=require(_0x55ad('0xe'));const util=require(_0x55ad('0xf'));if(!process[_0x55ad('0x10')]['REPORT_SERVICE_URL']){throw new Error(_0x55ad('0x11'));}module['exports']=function(_0x328579){var _0x4eebfe=logger[_0x55ad('0x12')]();_0x328579[_0x55ad('0x13')](_0x55ad('0x14'),async(_0x2f29df,_0x36d0be)=>{if(_0x2f29df['isNewInstance']){var _0x1d339e=_0x2f29df[_0x55ad('0x15')];_0x4eebfe['debug'](_0x1d339e);const _0x4bffc3=HttpClient(process[_0x55ad('0x10')]['REPORT_SERVICE_URL']);const _0x5aa93d=await _0x4bffc3[_0x55ad('0x16')]('/api/report/create',_0x1d339e);_0x4eebfe[_0x55ad('0x3')](_0x5aa93d[_0x55ad('0x17')]);return _0x36d0be();}else{return _0x36d0be();}});_0x328579[_0x55ad('0x18')]=async(_0x557da9,_0x3d267f,_0x238fcf,_0x4fb97e,_0x23d43c,_0x6c3cc4,_0x245b8a,_0x117a66,_0x90a45e,_0x227757,_0x392d5a,_0x1f0a07,_0x19bc38,_0x1c8e9c)=>{const _0x27989b=await _0x328579[_0x55ad('0x19')]({'report':_0x557da9,'type':_0x3d267f,'businessId':_0x238fcf,'departments':_0x4fb97e,'from':_0x23d43c,'to':_0x6c3cc4,'username':_0x245b8a,'srcAddress':_0x117a66,'srcPort':_0x90a45e,'dstAddress':_0x227757,'dstPort':_0x392d5a,'limit':_0x1f0a07,'skip':_0x19bc38,'sort':_0x1c8e9c});return _0x27989b;};_0x328579['searchDns']=async(_0x1caebd,_0x286da7,_0x17a3bf,_0x59eca3,_0x3cf23f,_0x28e899,_0x415154,_0x1aeedc,_0x4f403d,_0x73b07c,_0x14188f)=>{const _0x1b972e=await _0x328579[_0x55ad('0x19')]({'report':_0x1caebd,'type':_0x286da7,'businessId':_0x17a3bf,'departments':_0x59eca3,'from':_0x3cf23f,'to':_0x28e899,'username':_0x415154,'domain':_0x1aeedc,'limit':_0x4f403d,'skip':_0x73b07c,'sort':_0x14188f});return _0x1b972e;};_0x328579[_0x55ad('0x1a')](_0x55ad('0x1b'),{'description':_0x55ad('0x1c'),'accepts':[{'arg':_0x55ad('0x1d'),'type':_0x55ad('0x1e'),'required':!![]},{'arg':'type','type':_0x55ad('0x1e')},{'arg':'businessId','type':'string'},{'arg':'departments','type':[_0x55ad('0x1e')]},{'arg':'from','type':_0x55ad('0x1f')},{'arg':'to','type':'number'},{'arg':_0x55ad('0x20'),'type':'string'},{'arg':_0x55ad('0x21'),'type':_0x55ad('0x1e')},{'arg':_0x55ad('0x22'),'type':_0x55ad('0x1f')},{'arg':_0x55ad('0x23'),'type':'number'},{'arg':_0x55ad('0x24'),'type':'string'},{'arg':_0x55ad('0x25'),'type':_0x55ad('0x26'),'http':_0x55ad('0x27')}],'returns':{'root':!![]},'http':{'verb':_0x55ad('0x28')}});_0x328579[_0x55ad('0x29')]=async(_0xe7fdd8,_0xe10458,_0x42257e,_0x2a89b4,_0x310f19,_0x2f115d,_0x1d6555,_0x33e00c,_0x5d48f5,_0x3c3fef,_0x5e3e2c,_0x44c39d)=>{const _0x3c98c7=await _0x328579[_0x55ad('0x19')]({'report':_0xe7fdd8,'type':_0xe10458,'businessId':_0x42257e,'departments':_0x2a89b4,'from':_0x310f19,'to':_0x2f115d,'username':_0x1d6555,'domain':_0x33e00c,'url':_0x5d48f5,'limit':_0x3c3fef,'skip':_0x5e3e2c,'sort':_0x44c39d});return _0x3c98c7;};_0x328579[_0x55ad('0x1a')]('searchWebProxy',{'description':_0x55ad('0x2a'),'accepts':[{'arg':_0x55ad('0x1d'),'type':'string','required':!![]},{'arg':_0x55ad('0x2b'),'type':_0x55ad('0x1e')},{'arg':_0x55ad('0x2c'),'type':_0x55ad('0x1e')},{'arg':_0x55ad('0x2d'),'type':['string']},{'arg':_0x55ad('0x2e'),'type':_0x55ad('0x1f')},{'arg':'to','type':'number'},{'arg':'username','type':_0x55ad('0x1e')},{'arg':_0x55ad('0x21'),'type':_0x55ad('0x1e')},{'arg':_0x55ad('0x2f'),'type':_0x55ad('0x1e')},{'arg':'limit','type':_0x55ad('0x1f')},{'arg':_0x55ad('0x23'),'type':_0x55ad('0x1f')},{'arg':_0x55ad('0x24'),'type':_0x55ad('0x1e')},{'arg':_0x55ad('0x25'),'type':_0x55ad('0x26'),'http':_0x55ad('0x27')}],'returns':{'root':!![]},'http':{'verb':'get'}});_0x328579['search']=async _0x189450=>{const {type,report,from}=_0x189450;if(type==='json'){const _0x216c0b=HttpClient(process[_0x55ad('0x10')][_0x55ad('0x30')]);const _0x250a35=await _0x216c0b[_0x55ad('0x28')](_0x55ad('0x31')+report+'/search',{'params':_0x189450});return _0x250a35[_0x55ad('0x17')];}else{const _0x1379f2=0x3e8*0x3c;var _0x35be49=app[_0x55ad('0x32')][_0x55ad('0x33')];const _0xe168b2=await Axios({'url':process[_0x55ad('0x10')][_0x55ad('0x30')]+_0x55ad('0x31')+report+_0x55ad('0x34'),'timeout':_0x1379f2,'method':'get','responseType':'stream','params':_0x189450});let _0xe5c5ea=new Date(from)['toLocaleDateString']()+'-'+new Date(from)['toLocaleTimeString']()+'-'+type;if(type===_0x55ad('0x35')){_0xe5c5ea=Date[_0x55ad('0x36')]()+_0x55ad('0x37');}const _0x58391b=_0x55ad('0x38');const _0x5eb188=_0x35be49[_0x55ad('0x39')](_0x58391b,_0xe5c5ea);await _0xe168b2[_0x55ad('0x17')][_0x55ad('0x3a')](_0x5eb188);return{'container':_0x58391b,'fileName':_0xe5c5ea};}};_0x328579[_0x55ad('0x1a')](_0x55ad('0x18'),{'description':_0x55ad('0x3b'),'accepts':[{'arg':_0x55ad('0x1d'),'type':_0x55ad('0x1e'),'required':!![]},{'arg':'type','type':_0x55ad('0x1e')},{'arg':_0x55ad('0x2c'),'type':_0x55ad('0x1e')},{'arg':'departments','type':[_0x55ad('0x1e')]},{'arg':_0x55ad('0x2e'),'type':_0x55ad('0x1f')},{'arg':'to','type':_0x55ad('0x1f')},{'arg':'username','type':'string'},{'arg':_0x55ad('0x3c'),'type':_0x55ad('0x1e')},{'arg':_0x55ad('0x3d'),'type':_0x55ad('0x1e')},{'arg':_0x55ad('0x3e'),'type':_0x55ad('0x1e')},{'arg':_0x55ad('0x3f'),'type':_0x55ad('0x1e')},{'arg':_0x55ad('0x22'),'type':'number'},{'arg':_0x55ad('0x23'),'type':'number'},{'arg':_0x55ad('0x24'),'type':_0x55ad('0x1e')},{'arg':_0x55ad('0x25'),'type':_0x55ad('0x26'),'http':_0x55ad('0x27')}],'returns':{'root':!![]},'http':{'verb':_0x55ad('0x28')}});};