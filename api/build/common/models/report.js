var _0x9dfe=['c3RyZWFt','dG9Mb2NhbGVUaW1lU3RyaW5n','ZXhjZWw=','bm93','Lnhsc3g=','cmVwb3J0cw==','dXBsb2FkU3RyZWFt','cGlwZQ==','U2VhcmNoIE5ldGZsb3c=','c3JjQWRkcmVzcw==','c3JjUG9ydA==','ZHN0QWRkcmVzcw==','ZHN0UG9ydA==','YXBwbHk=','cmV0dXJuIChmdW5jdGlvbigpIA==','e30uY29uc3RydWN0b3IoInJldHVybiB0aGlzIikoICk=','Y29uc29sZQ==','bG9n','d2Fybg==','ZGVidWc=','aW5mbw==','ZXJyb3I=','ZXhjZXB0aW9u','dHJhY2U=','Li4vLi4vc2VydmVyL21vZHVsZXMvbG9nZ2Vy','Li4vLi4vc2VydmVyL3NlcnZlcg==','ZW52','UkVQT1JUX1NFUlZJQ0VfVVJM','aW52YWxpZCBSRVBPUlRfU0VSVklDRV9VUkw=','Y3JlYXRlTG9nZ2Vy','aXNOZXdJbnN0YW5jZQ==','aW5zdGFuY2U=','L2FwaS9yZXBvcnQvY3JlYXRl','c2VhcmNoTmV0Zmxvdw==','c2VhcmNo','c2VhcmNoRG5z','cmVtb3RlTWV0aG9k','U2VhcmNoIERucw==','cmVwb3J0','c3RyaW5n','dHlwZQ==','YnVzaW5lc3NJZA==','ZGVwYXJ0bWVudHM=','ZnJvbQ==','bnVtYmVy','dXNlcm5hbWU=','bGltaXQ=','c2tpcA==','c29ydA==','c2VhcmNoV2ViUHJveHk=','U2VhcmNoIFdlYlByb3h5','b3B0aW9ucw==','b2JqZWN0','b3B0aW9uc0Zyb21SZXF1ZXN0','Z2V0','L2FwaS8=','L3NlYXJjaA==','bW9kZWxz','QmlnRmlsZQ=='];(function(_0x1f2e9e,_0x3e7865){var _0x1c7b51=function(_0x4ddcf8){while(--_0x4ddcf8){_0x1f2e9e['push'](_0x1f2e9e['shift']());}};var _0x57d847=function(){var _0x5e94c6={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0xeee91a,_0x58ffb9,_0x97b424,_0x490923){_0x490923=_0x490923||{};var _0x542a7d=_0x58ffb9+'='+_0x97b424;var _0x1effee=0x0;for(var _0x1effee=0x0,_0x4beae7=_0xeee91a['length'];_0x1effee<_0x4beae7;_0x1effee++){var _0x3d5b53=_0xeee91a[_0x1effee];_0x542a7d+=';\x20'+_0x3d5b53;var _0x5d7119=_0xeee91a[_0x3d5b53];_0xeee91a['push'](_0x5d7119);_0x4beae7=_0xeee91a['length'];if(_0x5d7119!==!![]){_0x542a7d+='='+_0x5d7119;}}_0x490923['cookie']=_0x542a7d;},'removeCookie':function(){return'dev';},'getCookie':function(_0x39c90f,_0x3cba58){_0x39c90f=_0x39c90f||function(_0x690975){return _0x690975;};var _0x2a90a6=_0x39c90f(new RegExp('(?:^|;\x20)'+_0x3cba58['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x2bbfe9=function(_0xce8a96,_0x572878){_0xce8a96(++_0x572878);};_0x2bbfe9(_0x1c7b51,_0x3e7865);return _0x2a90a6?decodeURIComponent(_0x2a90a6[0x1]):undefined;}};var _0x2d19eb=function(){var _0x59853e=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x59853e['test'](_0x5e94c6['removeCookie']['toString']());};_0x5e94c6['updateCookie']=_0x2d19eb;var _0x48127a='';var _0x7deab8=_0x5e94c6['updateCookie']();if(!_0x7deab8){_0x5e94c6['setCookie'](['*'],'counter',0x1);}else if(_0x7deab8){_0x48127a=_0x5e94c6['getCookie'](null,'counter');}else{_0x5e94c6['removeCookie']();}};_0x57d847();}(_0x9dfe,0x1e5));var _0xe9df=function(_0x4706a6,_0x5a1c63){_0x4706a6=_0x4706a6-0x0;var _0x1bb705=_0x9dfe[_0x4706a6];if(_0xe9df['initialized']===undefined){(function(){var _0x423d7e;try{var _0xbdde6b=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x423d7e=_0xbdde6b();}catch(_0x384795){_0x423d7e=window;}var _0x336258='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x423d7e['atob']||(_0x423d7e['atob']=function(_0x29026d){var _0x6da4a7=String(_0x29026d)['replace'](/=+$/,'');for(var _0x44c11a=0x0,_0x2673bc,_0x3eec67,_0x2a8f19=0x0,_0x2f6c62='';_0x3eec67=_0x6da4a7['charAt'](_0x2a8f19++);~_0x3eec67&&(_0x2673bc=_0x44c11a%0x4?_0x2673bc*0x40+_0x3eec67:_0x3eec67,_0x44c11a++%0x4)?_0x2f6c62+=String['fromCharCode'](0xff&_0x2673bc>>(-0x2*_0x44c11a&0x6)):0x0){_0x3eec67=_0x336258['indexOf'](_0x3eec67);}return _0x2f6c62;});}());_0xe9df['base64DecodeUnicode']=function(_0xd7378b){var _0x39e8fd=atob(_0xd7378b);var _0x43e483=[];for(var _0x129353=0x0,_0x55ff31=_0x39e8fd['length'];_0x129353<_0x55ff31;_0x129353++){_0x43e483+='%'+('00'+_0x39e8fd['charCodeAt'](_0x129353)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x43e483);};_0xe9df['data']={};_0xe9df['initialized']=!![];}var _0x15c5fc=_0xe9df['data'][_0x4706a6];if(_0x15c5fc===undefined){var _0x534210=function(_0x1c49fa){this['rc4Bytes']=_0x1c49fa;this['states']=[0x1,0x0,0x0];this['newState']=function(){return'newState';};this['firstState']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*';this['secondState']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x534210['prototype']['checkState']=function(){var _0x489fed=new RegExp(this['firstState']+this['secondState']);return this['runState'](_0x489fed['test'](this['newState']['toString']())?--this['states'][0x1]:--this['states'][0x0]);};_0x534210['prototype']['runState']=function(_0x283141){if(!Boolean(~_0x283141)){return _0x283141;}return this['getState'](this['rc4Bytes']);};_0x534210['prototype']['getState']=function(_0x5b0abd){for(var _0x2dc46f=0x0,_0x2b1f4a=this['states']['length'];_0x2dc46f<_0x2b1f4a;_0x2dc46f++){this['states']['push'](Math['round'](Math['random']()));_0x2b1f4a=this['states']['length'];}return _0x5b0abd(this['states'][0x0]);};new _0x534210(_0xe9df)['checkState']();_0x1bb705=_0xe9df['base64DecodeUnicode'](_0x1bb705);_0xe9df['data'][_0x4706a6]=_0x1bb705;}else{_0x1bb705=_0x15c5fc;}return _0x1bb705;};var _0x9261=function(){var _0x20a584=!![];return function(_0xe384a5,_0x4b41a8){var _0x2127c6=_0x20a584?function(){if(_0x4b41a8){var _0x29787d=_0x4b41a8['apply'](_0xe384a5,arguments);_0x4b41a8=null;return _0x29787d;}}:function(){};_0x20a584=![];return _0x2127c6;};}();var _0x2fc712=_0x9261(this,function(){var _0x55ebe3=function(){return'\x64\x65\x76';},_0x5e7038=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x1e1408=function(){var _0x417036=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x417036['\x74\x65\x73\x74'](_0x55ebe3['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x1db741=function(){var _0x452df6=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x452df6['\x74\x65\x73\x74'](_0x5e7038['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x39cb2f=function(_0x4dd49a){var _0x5d86ed=~-0x1>>0x1+0xff%0x0;if(_0x4dd49a['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x5d86ed)){_0xbf09e3(_0x4dd49a);}};var _0xbf09e3=function(_0x4edaf5){var _0x1cfefb=~-0x4>>0x1+0xff%0x0;if(_0x4edaf5['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x1cfefb){_0x39cb2f(_0x4edaf5);}};if(!_0x1e1408()){if(!_0x1db741()){_0x39cb2f('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x39cb2f('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x39cb2f('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x2fc712();var _0xeedb73=function(){var _0x12329e=!![];return function(_0x4a2986,_0x1e58d8){var _0x2a62ad=_0x12329e?function(){if(_0x1e58d8){var _0xa7a420=_0x1e58d8[_0xe9df('0x0')](_0x4a2986,arguments);_0x1e58d8=null;return _0xa7a420;}}:function(){};_0x12329e=![];return _0x2a62ad;};}();var _0x153455=_0xeedb73(this,function(){var _0x297bd7=function(){};var _0x2a8aff;try{var _0x113f50=Function(_0xe9df('0x1')+_0xe9df('0x2')+');');_0x2a8aff=_0x113f50();}catch(_0x5487fd){_0x2a8aff=window;}if(!_0x2a8aff[_0xe9df('0x3')]){_0x2a8aff[_0xe9df('0x3')]=function(_0xb34bfc){var _0xf0666c={};_0xf0666c[_0xe9df('0x4')]=_0xb34bfc;_0xf0666c[_0xe9df('0x5')]=_0xb34bfc;_0xf0666c[_0xe9df('0x6')]=_0xb34bfc;_0xf0666c[_0xe9df('0x7')]=_0xb34bfc;_0xf0666c[_0xe9df('0x8')]=_0xb34bfc;_0xf0666c[_0xe9df('0x9')]=_0xb34bfc;_0xf0666c[_0xe9df('0xa')]=_0xb34bfc;return _0xf0666c;}(_0x297bd7);}else{_0x2a8aff[_0xe9df('0x3')][_0xe9df('0x4')]=_0x297bd7;_0x2a8aff[_0xe9df('0x3')]['warn']=_0x297bd7;_0x2a8aff[_0xe9df('0x3')][_0xe9df('0x6')]=_0x297bd7;_0x2a8aff[_0xe9df('0x3')][_0xe9df('0x7')]=_0x297bd7;_0x2a8aff[_0xe9df('0x3')][_0xe9df('0x8')]=_0x297bd7;_0x2a8aff[_0xe9df('0x3')]['exception']=_0x297bd7;_0x2a8aff[_0xe9df('0x3')][_0xe9df('0xa')]=_0x297bd7;}});_0x153455();'use strict';const config=require('../../server/modules/config');var logger=require(_0xe9df('0xb'));var app=require(_0xe9df('0xc'));var utility=require('../../server/modules/utility');var HttpClient=require('../../server/modules/httpClient');var Q=require('q');const fs=require('fs');const Path=require('path');const Axios=require('axios');const util=require('util');if(!process[_0xe9df('0xd')][_0xe9df('0xe')]){throw new Error(_0xe9df('0xf'));}module['exports']=function(_0x2b4774){var _0x3fe96a=logger[_0xe9df('0x10')]();_0x2b4774['observe']('after\x20save',async(_0x3d312d,_0x25bfa9)=>{if(_0x3d312d[_0xe9df('0x11')]){var _0x4eb5bd=_0x3d312d[_0xe9df('0x12')];_0x3fe96a['debug'](_0x4eb5bd);const _0x2a7f8e=HttpClient(process[_0xe9df('0xd')]['REPORT_SERVICE_URL']);const _0x56d66f=await _0x2a7f8e['post'](_0xe9df('0x13'),_0x4eb5bd);_0x3fe96a[_0xe9df('0x6')](_0x56d66f['data']);return _0x25bfa9();}else{return _0x25bfa9();}});_0x2b4774[_0xe9df('0x14')]=async(_0x532b84,_0x2552ce,_0x2e798d,_0x4a39d1,_0x456b60,_0x2f4070,_0x20688e,_0x17b637,_0x43f78c,_0x25e807,_0x5c7e7e,_0xdf27eb,_0x3f0edb,_0x580822)=>{const _0x36302e=await _0x2b4774[_0xe9df('0x15')]({'report':_0x532b84,'type':_0x2552ce,'businessId':_0x2e798d,'departments':_0x4a39d1,'from':_0x456b60,'to':_0x2f4070,'username':_0x20688e,'srcAddress':_0x17b637,'srcPort':_0x43f78c,'dstAddress':_0x25e807,'dstPort':_0x5c7e7e,'limit':_0xdf27eb,'skip':_0x3f0edb,'sort':_0x580822});return _0x36302e;};_0x2b4774[_0xe9df('0x16')]=async(_0x1bfeca,_0x4c4d68,_0x51d87c,_0x42d28d,_0x4dd1d8,_0x551edd,_0x322a0f,_0xbfa515,_0x14824e,_0x59f6b8,_0x35cfd0)=>{const _0x3382f3=await _0x2b4774[_0xe9df('0x15')]({'report':_0x1bfeca,'type':_0x4c4d68,'businessId':_0x51d87c,'departments':_0x42d28d,'from':_0x4dd1d8,'to':_0x551edd,'username':_0x322a0f,'domain':_0xbfa515,'limit':_0x14824e,'skip':_0x59f6b8,'sort':_0x35cfd0});return _0x3382f3;};_0x2b4774[_0xe9df('0x17')](_0xe9df('0x16'),{'description':_0xe9df('0x18'),'accepts':[{'arg':_0xe9df('0x19'),'type':_0xe9df('0x1a'),'required':!![]},{'arg':_0xe9df('0x1b'),'type':_0xe9df('0x1a')},{'arg':_0xe9df('0x1c'),'type':_0xe9df('0x1a')},{'arg':_0xe9df('0x1d'),'type':['string']},{'arg':_0xe9df('0x1e'),'type':_0xe9df('0x1f')},{'arg':'to','type':_0xe9df('0x1f')},{'arg':_0xe9df('0x20'),'type':_0xe9df('0x1a')},{'arg':'domain','type':'string'},{'arg':_0xe9df('0x21'),'type':_0xe9df('0x1f')},{'arg':_0xe9df('0x22'),'type':_0xe9df('0x1f')},{'arg':_0xe9df('0x23'),'type':_0xe9df('0x1a')},{'arg':'options','type':'object','http':'optionsFromRequest'}],'returns':{'root':!![]},'http':{'verb':'get'}});_0x2b4774[_0xe9df('0x24')]=async(_0x2ab4c3,_0x2e0f50,_0x3ba246,_0x478e4d,_0x2cdcd2,_0x4dacb9,_0x1cc301,_0x4642bf,_0x487617,_0x2006e5,_0x23676b,_0x16d516)=>{const _0x1a0544=await _0x2b4774[_0xe9df('0x15')]({'report':_0x2ab4c3,'type':_0x2e0f50,'businessId':_0x3ba246,'departments':_0x478e4d,'from':_0x2cdcd2,'to':_0x4dacb9,'username':_0x1cc301,'domain':_0x4642bf,'url':_0x487617,'limit':_0x2006e5,'skip':_0x23676b,'sort':_0x16d516});return _0x1a0544;};_0x2b4774[_0xe9df('0x17')](_0xe9df('0x24'),{'description':_0xe9df('0x25'),'accepts':[{'arg':'report','type':_0xe9df('0x1a'),'required':!![]},{'arg':'type','type':_0xe9df('0x1a')},{'arg':_0xe9df('0x1c'),'type':'string'},{'arg':_0xe9df('0x1d'),'type':[_0xe9df('0x1a')]},{'arg':_0xe9df('0x1e'),'type':_0xe9df('0x1f')},{'arg':'to','type':'number'},{'arg':'username','type':_0xe9df('0x1a')},{'arg':'domain','type':_0xe9df('0x1a')},{'arg':'url','type':_0xe9df('0x1a')},{'arg':_0xe9df('0x21'),'type':'number'},{'arg':_0xe9df('0x22'),'type':_0xe9df('0x1f')},{'arg':_0xe9df('0x23'),'type':_0xe9df('0x1a')},{'arg':_0xe9df('0x26'),'type':_0xe9df('0x27'),'http':_0xe9df('0x28')}],'returns':{'root':!![]},'http':{'verb':_0xe9df('0x29')}});_0x2b4774['search']=async _0x6f45f8=>{const {type,report,from}=_0x6f45f8;if(type==='json'){const _0x1b9e33=HttpClient(process['env']['REPORT_SERVICE_URL']);const _0x30bf33=await _0x1b9e33[_0xe9df('0x29')](_0xe9df('0x2a')+report+_0xe9df('0x2b'),{'params':_0x6f45f8});return _0x30bf33['data'];}else{const _0x2ba75a=0x3e8*0x3c;var _0x18bc71=app[_0xe9df('0x2c')][_0xe9df('0x2d')];const _0x585642=await Axios({'url':process['env']['REPORT_SERVICE_URL']+_0xe9df('0x2a')+report+_0xe9df('0x2b'),'timeout':_0x2ba75a,'method':_0xe9df('0x29'),'responseType':_0xe9df('0x2e'),'params':_0x6f45f8});let _0x25730b=new Date(from)['toLocaleDateString']()+'-'+new Date(from)[_0xe9df('0x2f')]()+'-'+type;if(type===_0xe9df('0x30')){_0x25730b=Date[_0xe9df('0x31')]()+_0xe9df('0x32');}const _0x5b3b82=_0xe9df('0x33');const _0x1eea33=_0x18bc71[_0xe9df('0x34')](_0x5b3b82,_0x25730b);await _0x585642['data'][_0xe9df('0x35')](_0x1eea33);return{'container':_0x5b3b82,'fileName':_0x25730b};}};_0x2b4774[_0xe9df('0x17')]('searchNetflow',{'description':_0xe9df('0x36'),'accepts':[{'arg':_0xe9df('0x19'),'type':_0xe9df('0x1a'),'required':!![]},{'arg':_0xe9df('0x1b'),'type':_0xe9df('0x1a')},{'arg':_0xe9df('0x1c'),'type':_0xe9df('0x1a')},{'arg':'departments','type':[_0xe9df('0x1a')]},{'arg':_0xe9df('0x1e'),'type':'number'},{'arg':'to','type':'number'},{'arg':'username','type':_0xe9df('0x1a')},{'arg':_0xe9df('0x37'),'type':_0xe9df('0x1a')},{'arg':_0xe9df('0x38'),'type':_0xe9df('0x1a')},{'arg':_0xe9df('0x39'),'type':_0xe9df('0x1a')},{'arg':_0xe9df('0x3a'),'type':_0xe9df('0x1a')},{'arg':_0xe9df('0x21'),'type':'number'},{'arg':_0xe9df('0x22'),'type':'number'},{'arg':'sort','type':_0xe9df('0x1a')},{'arg':_0xe9df('0x26'),'type':_0xe9df('0x27'),'http':'optionsFromRequest'}],'returns':{'root':!![]},'http':{'verb':'get'}});};