var _0x4d8f=['cHVzaA==','dXNlcm5hbWU=','ZUNCbXg=','c2Vzc2lvblRpbWU=','dXVld2I=','R2V0IFRvcCBNZW1iZXJzLg==','c3RyaW5n','T1FtY1g=','Y1FnY0Q=','VnNNVXA=','Y2FjaGVVc2FnZQ==','c3RyaW5naWZ5','TG5M','UVhFa0I=','eGRySWc=','ZmFpbGVkIHRvIGdldCB1c2FnZSBmcm9tIGNhY2hlIGJ5IGlkOiA=','QnNlemg=','alFLTGg=','enllelc=','d3Z3','TlpV','TnFBVlY=','emdKTnE=','blV1cFI=','RkdNWUo=','R1JoeXA=','THB1a1o=','TUhLaG8=','bVJtTVM=','Z25mTlE=','anFJSlk=','SnBN','cHJldmlld3Mgc2Vzc2lvbiBpcyBlbXB0eQ==','bldE','cXh3','MHw1fDd8M3w0fDJ8OHw2fDE=','SlN0dVY=','dVBjZVY=','c1FMWWo=','eUphRm8=','ZW9wbHg=','RXRhS3M=','c1B1UXQ=','cmFSWEY=','YXBwbHk=','U0dSaVc=','ZmFpbGVkIHRvIGNhY2hl','dkZtbGw=','ZE1xa2k=','cHJvbWlzZQ==','c2V0','c2Vzc2lvbklk','ZXJyb3I=','ZmFpbGVkIHRvIGNhY2hlIHVzYWdl','c0NaU1I=','ZVhLTG0=','ZmpIbVY=','bm9sbGU=','cGFyc2U=','a0NIS3o=','c3BsaXQ=','ZGVidWc=','aW5mbw==','bG9n','d2Fybg==','ZXhjZXB0aW9u','cmV0dXJuIChmdW5jdGlvbigpIA==','bm11','M3wwfDR8NXwxfDZ8Mg==','emh6RXg=','SG1zZ0I=','TGhwWG0=','Y29uc29sZQ==','bFl3ZUQ=','RnZ4ZHg=','RXJa','dHJhY2U=','SlVncGY=','Li4vLi4vc2VydmVyL21vZHVsZXMvY29uZmlnLmpz','Li4vLi4vc2VydmVyL21vZHVsZXMvbG9nZ2Vy','dW5kZXJzY29yZQ==','ZW52','S0FGS0FfUE9SVA==','cmVkaXM=','Y3JlYXRlQ2xpZW50','UkVESVM=','UE9SVA==','SE9TVA==','UHJvZHVjZXIgcmVhZHkuLi4=','S1hEcHY=','cmVmcmVzaE1ldGFkYXRh','QUNDT1VOVElOR19UT1BJQw==','Q1Jq','QHJlZnJlc2hNZXRhZGF0YSBFcnJvcjo=','VWFSa00=','SERJWHU=','ZldYRk8=','Snlq','QmVsSlU=','ZXhwb3J0cw==','dWhN','SXlu','UHJvZHVjZXIgcHJlcGFyYXRpb24gZmFpbGVkOg==','anhQ','cGVT','WVNY','c3RhcnREYXRl','bnVtYmVy','U3RhcnQgRGF0ZQ==','b3B0aW9ucw==','b2JqZWN0','b3B0aW9uc0Zyb21SZXF1ZXN0','cmVwb3J0U3RhdHVz','R2V0IHJlcG9ydC4=','Z2V0VG9wTWVtYmVycw==','Y2FsY3VsYXRlVXNhZ2U=','Z2V0VXNhZ2VGcm9tQ2FjaGU=','VHNNT3E=','VWd1VGQ=','dXBsb2Fk','ZG93bmxvYWQ=','WmJkV1c=','Vldu','YWxs','Y3VycmVudFVzZXJJZA==','T2hYSmI=','dnJCVWQ=','Z2V0QnVzaW5lc3NVc2FnZQ==','d2NoQ1o=','ZGVwYXJ0bWVudElk','ZW11aVA=','bVhQelo=','U2ZOWGM=','Q0Z1YkI=','aXd5c0c=','SUJ5SGs=','VXdIems=','dGFibGU=','VmFHcWI=','ZHpqa1E=','cGFyc2VJbnQ=','S093aW4=','TXRCcFM=','MnwxfDR8M3wwfDV8Ng==','WFRC','UEZ3eFg=','Z2V0RGF0YWJhc2VJbmZv','Z2V0VG9wTWVtYmVyc0J5VXNhZ2U=','VHBPTks=','QlJKR2c=','ZnVBVEs='];(function(_0x5f3f88,_0x562baf){var _0xd08119=function(_0x42dbf7){while(--_0x42dbf7){_0x5f3f88['push'](_0x5f3f88['shift']());}};var _0xa9557a=function(){var _0x12a70c={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x273a32,_0xfb4034,_0x40a703,_0x14dc10){_0x14dc10=_0x14dc10||{};var _0xc39edf=_0xfb4034+'='+_0x40a703;var _0x5ac51c=0x0;for(var _0x5ac51c=0x0,_0x4d9e3a=_0x273a32['length'];_0x5ac51c<_0x4d9e3a;_0x5ac51c++){var _0x5def07=_0x273a32[_0x5ac51c];_0xc39edf+=';\x20'+_0x5def07;var _0x54cc78=_0x273a32[_0x5def07];_0x273a32['push'](_0x54cc78);_0x4d9e3a=_0x273a32['length'];if(_0x54cc78!==!![]){_0xc39edf+='='+_0x54cc78;}}_0x14dc10['cookie']=_0xc39edf;},'removeCookie':function(){return'dev';},'getCookie':function(_0x14e05a,_0x6c6a08){_0x14e05a=_0x14e05a||function(_0x27c033){return _0x27c033;};var _0x3278ff=_0x14e05a(new RegExp('(?:^|;\x20)'+_0x6c6a08['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x15d895=function(_0x4c7d9c,_0x1818cf){_0x4c7d9c(++_0x1818cf);};_0x15d895(_0xd08119,_0x562baf);return _0x3278ff?decodeURIComponent(_0x3278ff[0x1]):undefined;}};var _0x521d18=function(){var _0x2fabf1=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x2fabf1['test'](_0x12a70c['removeCookie']['toString']());};_0x12a70c['updateCookie']=_0x521d18;var _0x564d5b='';var _0x411d24=_0x12a70c['updateCookie']();if(!_0x411d24){_0x12a70c['setCookie'](['*'],'counter',0x1);}else if(_0x411d24){_0x564d5b=_0x12a70c['getCookie'](null,'counter');}else{_0x12a70c['removeCookie']();}};_0xa9557a();}(_0x4d8f,0xb6));var _0xf4d8=function(_0x3cd8cb,_0x3db5bf){_0x3cd8cb=_0x3cd8cb-0x0;var _0x1c44e2=_0x4d8f[_0x3cd8cb];if(_0xf4d8['initialized']===undefined){(function(){var _0x3ae8dc;try{var _0x143154=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x3ae8dc=_0x143154();}catch(_0x20fa55){_0x3ae8dc=window;}var _0x971b9a='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x3ae8dc['atob']||(_0x3ae8dc['atob']=function(_0x5871b9){var _0x52b36e=String(_0x5871b9)['replace'](/=+$/,'');for(var _0x99c4ef=0x0,_0x29f431,_0xeb8db5,_0x15c464=0x0,_0x3506c4='';_0xeb8db5=_0x52b36e['charAt'](_0x15c464++);~_0xeb8db5&&(_0x29f431=_0x99c4ef%0x4?_0x29f431*0x40+_0xeb8db5:_0xeb8db5,_0x99c4ef++%0x4)?_0x3506c4+=String['fromCharCode'](0xff&_0x29f431>>(-0x2*_0x99c4ef&0x6)):0x0){_0xeb8db5=_0x971b9a['indexOf'](_0xeb8db5);}return _0x3506c4;});}());_0xf4d8['base64DecodeUnicode']=function(_0x123e09){var _0x28640b=atob(_0x123e09);var _0x288020=[];for(var _0x3fef2=0x0,_0x56a042=_0x28640b['length'];_0x3fef2<_0x56a042;_0x3fef2++){_0x288020+='%'+('00'+_0x28640b['charCodeAt'](_0x3fef2)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x288020);};_0xf4d8['data']={};_0xf4d8['initialized']=!![];}var _0x30108b=_0xf4d8['data'][_0x3cd8cb];if(_0x30108b===undefined){var _0x5b8bf8=function(_0x3e56df){this['rc4Bytes']=_0x3e56df;this['states']=[0x1,0x0,0x0];this['newState']=function(){return'newState';};this['firstState']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*';this['secondState']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x5b8bf8['prototype']['checkState']=function(){var _0x5248ec=new RegExp(this['firstState']+this['secondState']);return this['runState'](_0x5248ec['test'](this['newState']['toString']())?--this['states'][0x1]:--this['states'][0x0]);};_0x5b8bf8['prototype']['runState']=function(_0x5d6dbc){if(!Boolean(~_0x5d6dbc)){return _0x5d6dbc;}return this['getState'](this['rc4Bytes']);};_0x5b8bf8['prototype']['getState']=function(_0x1337b0){for(var _0x3e4053=0x0,_0xa0fb71=this['states']['length'];_0x3e4053<_0xa0fb71;_0x3e4053++){this['states']['push'](Math['round'](Math['random']()));_0xa0fb71=this['states']['length'];}return _0x1337b0(this['states'][0x0]);};new _0x5b8bf8(_0xf4d8)['checkState']();_0x1c44e2=_0xf4d8['base64DecodeUnicode'](_0x1c44e2);_0xf4d8['data'][_0x3cd8cb]=_0x1c44e2;}else{_0x1c44e2=_0x30108b;}return _0x1c44e2;};var _0x57ea6b=function(){var _0x5e3f02=!![];return function(_0xe5d580,_0x491780){var _0x3af993=_0x5e3f02?function(){if(_0x491780){var _0x184f86=_0x491780['apply'](_0xe5d580,arguments);_0x491780=null;return _0x184f86;}}:function(){};_0x5e3f02=![];return _0x3af993;};}();var _0x416378=_0x57ea6b(this,function(){var _0x42a5b0=function(){return'\x64\x65\x76';},_0xe71ee=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x30d6b7=function(){var _0xa67b6a=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0xa67b6a['\x74\x65\x73\x74'](_0x42a5b0['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x14be29=function(){var _0x22952c=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x22952c['\x74\x65\x73\x74'](_0xe71ee['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x30a761=function(_0x1eb530){var _0x5f082f=~-0x1>>0x1+0xff%0x0;if(_0x1eb530['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x5f082f)){_0x41e46b(_0x1eb530);}};var _0x41e46b=function(_0x51de61){var _0x11b594=~-0x4>>0x1+0xff%0x0;if(_0x51de61['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x11b594){_0x30a761(_0x51de61);}};if(!_0x30d6b7()){if(!_0x14be29()){_0x30a761('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x30a761('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x30a761('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x416378();var _0x286510=function(){var _0x1a5204={'SGRiW':function _0x346a0c(_0x651875,_0xdd4a0e){return _0x651875(_0xdd4a0e);},'vFmll':function _0x3f3706(_0x1dd838){return _0x1dd838();},'dMqki':_0xf4d8('0x0'),'sQLYj':_0xf4d8('0x1'),'yJaFo':function _0x231865(_0x1bd538){return _0x1bd538();},'eoplx':function _0x3c4315(_0x4f47c4,_0x5f5446){return _0x4f47c4(_0x5f5446);},'EtaKs':function _0x57d79b(_0x1c4121,_0x5aebdf){return _0x1c4121!==_0x5aebdf;},'sPuQt':_0xf4d8('0x2'),'raRXF':_0xf4d8('0x3'),'JStuV':'XNG','uPceV':'rnA','kCHKz':_0xf4d8('0x4')};if(_0x1a5204[_0xf4d8('0x5')]!==_0x1a5204[_0xf4d8('0x6')]){var _0x34ce2f=!![];return function(_0x55bf99,_0x574599){var _0x3afe5a={'CspJm':function _0x402128(_0x4063e8,_0x338beb){return _0x1a5204['SGRiW'](_0x4063e8,_0x338beb);},'fjHmV':_0x1a5204[_0xf4d8('0x7')],'nolle':function _0x176ae7(_0x794cb2){return _0x1a5204[_0xf4d8('0x8')](_0x794cb2);},'axlRQ':function _0x34f9e6(_0x38e318,_0x1a0a31){return _0x1a5204[_0xf4d8('0x9')](_0x38e318,_0x1a0a31);}};if(_0x1a5204[_0xf4d8('0xa')](_0x1a5204[_0xf4d8('0xb')],_0x1a5204[_0xf4d8('0xc')])){var _0x29bfa2=_0x34ce2f?function(){if(_0x574599){var _0x372f0b=_0x574599[_0xf4d8('0xd')](_0x55bf99,arguments);_0x574599=null;return _0x372f0b;}}:function(){var _0x1493aa={'sCZSR':function _0x2ac333(_0x471559,_0x18b64a){return _0x1a5204[_0xf4d8('0xe')](_0x471559,_0x18b64a);},'eXKLm':_0xf4d8('0xf'),'sDhnx':function _0x34bc44(_0x21260d){return _0x1a5204[_0xf4d8('0x10')](_0x21260d);}};if(_0xf4d8('0x0')===_0x1a5204[_0xf4d8('0x11')]){}else{return Q[_0xf4d8('0x12')]((_0x190dea,_0x424d1d)=>{redisClient[_0xf4d8('0x13')](usage[_0xf4d8('0x14')],JSON['stringify'](_0x30d593),'EX',0xe10,function(_0x39627f){if(_0x9e64f6){log[_0xf4d8('0x15')](_0xf4d8('0x16'),_0x2b8234);return _0x1493aa[_0xf4d8('0x17')](_0x18a6e3,_0x1493aa[_0xf4d8('0x18')]);}return _0x1493aa['sDhnx'](_0x1aae6a);});});}};_0x34ce2f=![];return _0x29bfa2;}else{redisClient['get'](_0x2f6edd,(_0x2b5876,_0x36bdbf)=>{if(_0x1529a8){log[_0xf4d8('0x15')]('failed\x20to\x20get\x20usage\x20from\x20cache\x20by\x20id:\x20'+_0x4b2d7d);return _0x3afe5a['CspJm'](_0x207ac7,_0x1d7de9);}if(!_0x538b16){log['warn'](_0x3afe5a[_0xf4d8('0x19')]);return _0x3afe5a[_0xf4d8('0x1a')](_0xfd1f30);}return _0x3afe5a['axlRQ'](_0x55ac5d,JSON[_0xf4d8('0x1b')](_0x21da02));});}};}else{var _0x5e8342=_0x1a5204[_0xf4d8('0x1c')][_0xf4d8('0x1d')]('|'),_0x26c18a=0x0;while(!![]){switch(_0x5e8342[_0x26c18a++]){case'0':var _0x17eb5a={};continue;case'1':return _0xc4aeea;continue;case'2':c['error']=_0xbd5966;continue;case'3':c[_0xf4d8('0x1e')]=_0x41ba9e;continue;case'4':c[_0xf4d8('0x1f')]=_0x298234;continue;case'5':c[_0xf4d8('0x20')]=_0x231909;continue;case'6':c['trace']=_0x44b4f3;continue;case'7':c[_0xf4d8('0x21')]=_0xa33bb3;continue;case'8':c[_0xf4d8('0x22')]=_0x1b6000;continue;}break;}}}();var _0x133ace=_0x286510(this,function(){var _0x35c2ba={'zhzEx':function _0xf91635(_0x428f18,_0x1fee12){return _0x428f18+_0x1fee12;},'JkPyP':function _0x301530(_0x4ccacc,_0x136f3f){return _0x4ccacc+_0x136f3f;},'HmsgB':_0xf4d8('0x23'),'LhpXm':'{}.constructor(\x22return\x20this\x22)(\x20)','IUEiu':function _0x54ede4(_0x59634c){return _0x59634c();},'SyUrS':function _0x2c347a(_0x36dcec,_0x426230){return _0x36dcec===_0x426230;},'lYweD':_0xf4d8('0x24'),'JUgpf':'Producer\x20ready...','GrvGQ':_0xf4d8('0x25')};var _0x233826=function(){};var _0x2ec1e8;try{var _0xa76e52=Function(_0x35c2ba[_0xf4d8('0x26')](_0x35c2ba['JkPyP'](_0x35c2ba[_0xf4d8('0x27')],_0x35c2ba[_0xf4d8('0x28')]),');'));_0x2ec1e8=_0x35c2ba['IUEiu'](_0xa76e52);}catch(_0xf25706){_0x2ec1e8=window;}if(!_0x2ec1e8[_0xf4d8('0x29')]){var _0x1fcf4e={'Fvxdx':function _0x77bbfb(_0x29f57b,_0x2d60e8){return _0x35c2ba['SyUrS'](_0x29f57b,_0x2d60e8);}};if(_0x35c2ba[_0xf4d8('0x2a')]===_0x35c2ba['lYweD']){_0x2ec1e8[_0xf4d8('0x29')]=function(_0x13a528){if(_0x1fcf4e[_0xf4d8('0x2b')](_0xf4d8('0x2c'),_0xf4d8('0x2c'))){var _0x3ce68f={};_0x3ce68f[_0xf4d8('0x20')]=_0x13a528;_0x3ce68f[_0xf4d8('0x21')]=_0x13a528;_0x3ce68f[_0xf4d8('0x1e')]=_0x13a528;_0x3ce68f['info']=_0x13a528;_0x3ce68f['error']=_0x13a528;_0x3ce68f[_0xf4d8('0x22')]=_0x13a528;_0x3ce68f[_0xf4d8('0x2d')]=_0x13a528;return _0x3ce68f;}else{_0x176ecc=null;}}(_0x233826);}else{log[_0xf4d8('0x21')](_0x35c2ba[_0xf4d8('0x2e')]);kafkaClient['refreshMetadata']([config['ACCOUNTING_TOPIC']],function(_0x49df71){log[_0xf4d8('0x1e')]('@refreshMetadata\x20Error:',_0x1b54f2);});}}else{var _0x25438a=_0x35c2ba['GrvGQ'][_0xf4d8('0x1d')]('|'),_0x164572=0x0;while(!![]){switch(_0x25438a[_0x164572++]){case'0':_0x2ec1e8[_0xf4d8('0x29')][_0xf4d8('0x21')]=_0x233826;continue;case'1':_0x2ec1e8[_0xf4d8('0x29')][_0xf4d8('0x15')]=_0x233826;continue;case'2':_0x2ec1e8[_0xf4d8('0x29')][_0xf4d8('0x2d')]=_0x233826;continue;case'3':_0x2ec1e8[_0xf4d8('0x29')]['log']=_0x233826;continue;case'4':_0x2ec1e8[_0xf4d8('0x29')][_0xf4d8('0x1e')]=_0x233826;continue;case'5':_0x2ec1e8['console'][_0xf4d8('0x1f')]=_0x233826;continue;case'6':_0x2ec1e8[_0xf4d8('0x29')][_0xf4d8('0x22')]=_0x233826;continue;}break;}}});_0x133ace();'use strict';var app=require('../../server/server');var utility=require('../../server/modules/utility');var Q=require('q');var kafka=require('kafka-node');var config=require(_0xf4d8('0x2f'));var logger=require(_0xf4d8('0x30'));var log=logger['createLogger']();var _=require(_0xf4d8('0x31'));var kafkaClient=new kafka['KafkaClient']({'kafkaHost':process[_0xf4d8('0x32')]['KAFKA_IP']+':'+process[_0xf4d8('0x32')][_0xf4d8('0x33')]});const db=require('../../server/modules/db.factory');var kafkaProducer=new kafka['Producer'](kafkaClient,{'partitionerType':0x2});var redis=require(_0xf4d8('0x34'));var redisClient=redis[_0xf4d8('0x35')](config[_0xf4d8('0x36')][_0xf4d8('0x37')],config[_0xf4d8('0x36')][_0xf4d8('0x38')]);kafkaProducer['on']('ready',function(){var _0xe81377={'KXDpv':_0xf4d8('0x39')};log[_0xf4d8('0x21')](_0xe81377[_0xf4d8('0x3a')]);kafkaClient[_0xf4d8('0x3b')]([config[_0xf4d8('0x3c')]],function(_0x2ef75c){var _0x4beb12={'WqGvj':function _0x38d1b(_0x1bf5cf,_0x140667){return _0x1bf5cf!==_0x140667;},'UaRkM':_0xf4d8('0x3d'),'HDIXu':_0xf4d8('0x1'),'fWXFO':_0xf4d8('0x3e')};if(_0x4beb12['WqGvj'](_0x4beb12[_0xf4d8('0x3f')],_0x4beb12[_0xf4d8('0x3f')])){log[_0xf4d8('0x21')](_0x4beb12[_0xf4d8('0x40')]);return _0x1340d9();}else{log[_0xf4d8('0x1e')](_0x4beb12[_0xf4d8('0x41')],_0x2ef75c);}});});kafkaProducer['on'](_0xf4d8('0x15'),function(_0x20aa52){var _0x54d23f={'Bbqyv':function _0x230624(_0x2fab0c,_0x522108){return _0x2fab0c===_0x522108;},'BelJU':_0xf4d8('0x42'),'Pcrbl':'Producer\x20preparation\x20failed:'};if(_0x54d23f['Bbqyv'](_0x54d23f['BelJU'],_0x54d23f[_0xf4d8('0x43')])){log[_0xf4d8('0x15')](_0x54d23f['Pcrbl'],_0x20aa52);}else{}});module[_0xf4d8('0x44')]=function(_0x1f5a17){var _0x58f280={'TsMOq':function _0x32dafe(_0x18c146,_0x3c00af){return _0x18c146!==_0x3c00af;},'UguTd':_0xf4d8('0x45'),'ZbdWW':function _0x507759(_0x4a8d91,_0x5eb8e5){return _0x4a8d91-_0x5eb8e5;},'IByHk':function _0x3cbbaf(_0x591c1a,_0x52afa9){return _0x591c1a===_0x52afa9;},'UwHzk':_0xf4d8('0x46'),'VaGqb':_0xf4d8('0x47'),'KOwin':_0xf4d8('0x48'),'MtBpS':_0xf4d8('0x49'),'PFwxX':'XTB','TpONK':function _0x52da87(_0x427e0a,_0x3cb51e){return _0x427e0a!==_0x3cb51e;},'BRJGg':'Hpj','fuATK':_0xf4d8('0x4a'),'eCBmx':function _0x3cb46a(_0x1af4f4,_0x11e9f8){return _0x1af4f4(_0x11e9f8);},'wchCZ':'Get\x20usage\x20report.','sEDSu':'string','emuiP':'departmentId','mXPzZ':_0xf4d8('0x4b'),'CFubB':_0xf4d8('0x4c'),'OQmcX':_0xf4d8('0x4d'),'SfNXc':'endDate','iwysG':_0xf4d8('0x4e'),'cQgcD':_0xf4d8('0x4f'),'VsMUp':_0xf4d8('0x50'),'dzjkQ':_0xf4d8('0x51'),'YWsKL':_0xf4d8('0x52'),'uuewb':_0xf4d8('0x53')};_0x1f5a17[_0xf4d8('0x54')]=async(_0x676b09,_0x47a9f2)=>{let {upload,download,sessionTime}=_0x47a9f2;const _0x274bc7=await _0x1f5a17[_0xf4d8('0x55')](_0x676b09);if(_0x274bc7){if(_0x58f280[_0xf4d8('0x56')](_0x58f280[_0xf4d8('0x57')],_0xf4d8('0x45'))){_0x1f90b7=_0xe187ce;}else{upload=_0x58f280['ZbdWW'](upload,_0x274bc7[_0xf4d8('0x58')]);download=download-_0x274bc7[_0xf4d8('0x59')];sessionTime=_0x58f280[_0xf4d8('0x5a')](sessionTime,_0x274bc7['sessionTime']);}}return{'upload':upload,'download':download,'sessionTime':sessionTime};};_0x1f5a17['getUsage']=async(_0xdc6326,_0x1b7c7d,_0x241c99,_0x38fb9b)=>{var _0xc207e7={'XsESn':_0xf4d8('0x5b'),'OhXJb':function _0x52f14b(_0x4b97e0,_0x5b8a72){return _0x4b97e0===_0x5b8a72;},'vrBUd':_0xf4d8('0x5c')};if(_0xf4d8('0x5b')===_0xc207e7['XsESn']){var _0x589949=_0x38fb9b[_0xf4d8('0x5d')];if(!_0xdc6326){return{'bulk':0x0,'download':0x0,'upload':0x0,'sessionTime':0x0};}if(_0xc207e7[_0xf4d8('0x5e')](_0xdc6326,_0xc207e7[_0xf4d8('0x5f')])){_0xdc6326=null;}const _0x44ddbc=await db[_0xf4d8('0x60')](_0x589949,_0xdc6326,_0x1b7c7d,_0x241c99);return _0x44ddbc;}else{var _0x1e7821=_0x38fb9b['currentUserId'];if(!_0x1ed482){return{'_0x2c2dc3':0x0,'_0x253a81':0x0,'_0x4dea0f':0x0,'_0x1ba468':0x0};}if(_0x5b132e===_0xf4d8('0x5c')){_0x12c0e7=null;}const _0x31457b=await db[_0xf4d8('0x60')](_0x156c3e,_0x5246b2,_0x35472f,_0x3d8ad4);return _0x5aab8c;}};_0x1f5a17['remoteMethod']('getUsage',{'description':_0x58f280[_0xf4d8('0x61')],'accepts':[{'arg':_0xf4d8('0x62'),'type':_0x58f280['sEDSu'],'description':_0x58f280[_0xf4d8('0x63')]},{'arg':_0x58f280[_0xf4d8('0x64')],'type':_0x58f280['CFubB'],'required':!![],'description':_0x58f280['OQmcX']},{'arg':_0x58f280[_0xf4d8('0x65')],'type':_0x58f280[_0xf4d8('0x66')],'required':!![],'description':'End\x20Date'},{'arg':_0x58f280[_0xf4d8('0x67')],'type':_0x58f280['cQgcD'],'http':_0x58f280['VsMUp']}],'returns':{'root':!![]}});_0x1f5a17[_0xf4d8('0x51')]=async()=>{const _0x466d84=await db['getDatabaseInfo']();const _0x49ca22={};for(const _0x668eab of _0x466d84){if(_0x58f280[_0xf4d8('0x68')]('Iyn',_0x58f280[_0xf4d8('0x69')])){_0x49ca22[_0x668eab[_0xf4d8('0x6a')]]=_0x668eab;}else{log[_0xf4d8('0x15')](_0x58f280[_0xf4d8('0x6b')],_0x2d4587);}}return{'db':_0x49ca22};};_0x1f5a17['remoteMethod'](_0x58f280[_0xf4d8('0x6c')],{'description':_0x58f280['YWsKL'],'accepts':[],'returns':{'root':!![]}});_0x1f5a17[_0xf4d8('0x53')]=async(_0x5e0dad,_0xbc62d9,_0x4502b8,_0x1f52f4)=>{var _0x4e1ee4=_0x1f52f4['currentUserId'];var _0x248341=Number[_0xf4d8('0x6d')](_0xbc62d9);var _0x1bf879=Number[_0xf4d8('0x6d')](_0x4502b8);const _0x1157c1=0xa;const _0x4102f9=0x0;const _0xe40043=[];const _0x39372c=[];const _0x12cc41=[];const _0x7d4784=[];if(!_0x5e0dad){if(_0x58f280[_0xf4d8('0x6e')]!==_0x58f280[_0xf4d8('0x6f')]){return{'username':_0xe40043,'upload':_0x39372c,'download':_0x12cc41,'sessionTime':_0x7d4784};}else{var _0x20c2dc=_0xf4d8('0x70')[_0xf4d8('0x1d')]('|'),_0x31a887=0x0;while(!![]){switch(_0x20c2dc[_0x31a887++]){case'0':that[_0xf4d8('0x29')][_0xf4d8('0x15')]=_0x46e8e4;continue;case'1':that[_0xf4d8('0x29')][_0xf4d8('0x21')]=_0x27dfb3;continue;case'2':that['console'][_0xf4d8('0x20')]=_0x5872d;continue;case'3':that[_0xf4d8('0x29')][_0xf4d8('0x1f')]=_0x51e09e;continue;case'4':that[_0xf4d8('0x29')][_0xf4d8('0x1e')]=_0x17f663;continue;case'5':that[_0xf4d8('0x29')]['exception']=_0x33ff0c;continue;case'6':that['console'][_0xf4d8('0x2d')]=_0x5a2d97;continue;}break;}}}if(_0x5e0dad==='all'){if(_0x58f280[_0xf4d8('0x56')](_0xf4d8('0x71'),_0x58f280[_0xf4d8('0x72')])){const _0x2886ca=await db[_0xf4d8('0x73')]();const _0x578e7f={};for(const _0x537427 of _0x4b0116){info[tb[_0xf4d8('0x6a')]]=_0x478465;}return{'_0x215eb3':_0x1344f5};}else{_0x5e0dad=null;}}const _0x331677=await db[_0xf4d8('0x74')](_0x4e1ee4,_0x5e0dad,_0x248341,_0x1bf879,_0x1157c1,_0x4102f9);for(const _0x586f87 of _0x331677){if(_0x58f280[_0xf4d8('0x75')](_0x58f280[_0xf4d8('0x76')],_0x58f280[_0xf4d8('0x77')])){_0xe40043[_0xf4d8('0x78')](_0x586f87[_0xf4d8('0x79')]);_0x39372c[_0xf4d8('0x78')](_0x58f280[_0xf4d8('0x7a')](Number,_0x586f87['upload']));_0x12cc41['push'](_0x58f280[_0xf4d8('0x7a')](Number,_0x586f87[_0xf4d8('0x59')]));_0x7d4784[_0xf4d8('0x78')](_0x58f280['eCBmx'](Number,_0x586f87[_0xf4d8('0x7b')]));}else{_0x4240fb=null;}}return{'username':_0xe40043,'upload':_0x39372c,'download':_0x12cc41,'sessionTime':_0x7d4784};};_0x1f5a17['remoteMethod'](_0x58f280[_0xf4d8('0x7c')],{'description':_0xf4d8('0x7d'),'accepts':[{'arg':_0x58f280[_0xf4d8('0x63')],'type':_0xf4d8('0x7e'),'description':_0x58f280['emuiP']},{'arg':_0x58f280[_0xf4d8('0x64')],'type':_0x58f280[_0xf4d8('0x66')],'required':!![],'description':_0x58f280[_0xf4d8('0x7f')]},{'arg':_0x58f280[_0xf4d8('0x65')],'type':_0xf4d8('0x4c'),'required':!![],'description':'End\x20Date'},{'arg':_0x58f280[_0xf4d8('0x67')],'type':_0x58f280[_0xf4d8('0x80')],'http':_0x58f280[_0xf4d8('0x81')]}],'returns':{'root':!![]}});_0x1f5a17[_0xf4d8('0x82')]=function(_0x55bcde){return Q['promise']((_0x40aefc,_0x3e4290)=>{redisClient['set'](_0x55bcde[_0xf4d8('0x14')],JSON[_0xf4d8('0x83')](_0x55bcde),'EX',0xe10,function(_0x5cb457){var _0x13f170={'QXEkB':_0xf4d8('0x84'),'xdrIg':'Coo','Bsezh':function _0x7be705(_0x5f3991,_0x22d80c){return _0x5f3991(_0x22d80c);},'jQKLh':function _0x193391(_0x17a4b7,_0x46e1ee){return _0x17a4b7(_0x46e1ee);},'zyezW':_0xf4d8('0xf')};if(_0x13f170[_0xf4d8('0x85')]===_0x13f170[_0xf4d8('0x86')]){log['error'](_0xf4d8('0x87')+_0x416eca);return _0x13f170[_0xf4d8('0x88')](_0x43035c,_0x497945);}else{if(_0x5cb457){log[_0xf4d8('0x15')](_0xf4d8('0x16'),_0x5cb457);return _0x13f170[_0xf4d8('0x89')](_0x3e4290,_0x13f170[_0xf4d8('0x8a')]);}return _0x40aefc();}});});};_0x1f5a17['getUsageFromCache']=function(_0x426730){var _0x23e1da={'nUupR':function _0x92e672(_0x485965,_0x96fb1d){return _0x485965(_0x96fb1d);},'VydPe':_0xf4d8('0xf'),'MHKho':function _0x11d681(_0x2fd4c9){return _0x2fd4c9();},'FGMYJ':function _0x324d39(_0x565f7f,_0x5575dd){return _0x565f7f(_0x5575dd);},'GRhyp':function _0x20f165(_0x4514d6,_0xea7328){return _0x4514d6===_0xea7328;},'LpukZ':'biy','NqAVV':function _0x5c07dd(_0x4962d0,_0x529f1c){return _0x4962d0!==_0x529f1c;},'mRmMS':_0xf4d8('0x8b'),'gnfNQ':'GVR','zgJNq':_0xf4d8('0x8c')};if(_0x23e1da[_0xf4d8('0x8d')](_0x23e1da[_0xf4d8('0x8e')],_0x23e1da[_0xf4d8('0x8e')])){redisClient['set'](usage[_0xf4d8('0x14')],JSON[_0xf4d8('0x83')](_0x10ed9f),'EX',0xe10,function(_0x7105a7){if(_0x147a1d){log[_0xf4d8('0x15')](_0xf4d8('0x16'),_0x5e9e5d);return _0x23e1da[_0xf4d8('0x8f')](_0x269f23,_0x23e1da['VydPe']);}return _0x23e1da['MHKho'](_0x2b645d);});}else{return Q['promise']((_0x5bb8fd,_0x1e695d)=>{var _0x27a85d={'LKNQR':function _0x3488fe(_0x434722,_0x20650e){return _0x23e1da[_0xf4d8('0x90')](_0x434722,_0x20650e);},'Zyxjh':function _0xd7d05a(_0x5cc933,_0x3c0308){return _0x23e1da[_0xf4d8('0x91')](_0x5cc933,_0x3c0308);},'JpZbx':_0x23e1da[_0xf4d8('0x92')],'jqIJY':function _0xb17e71(_0x27a72a){return _0x23e1da[_0xf4d8('0x93')](_0x27a72a);}};if(_0x23e1da[_0xf4d8('0x8d')](_0x23e1da[_0xf4d8('0x94')],_0x23e1da[_0xf4d8('0x95')])){redisClient['get'](_0x426730,(_0x4e975b,_0x4987a8)=>{if(_0x4e975b){log['error']('failed\x20to\x20get\x20usage\x20from\x20cache\x20by\x20id:\x20'+_0x426730);return _0x27a85d['LKNQR'](_0x1e695d,_0x4e975b);}if(!_0x4987a8){if(_0x27a85d['Zyxjh'](_0x27a85d['JpZbx'],'LUk')){if(_0xd408b2){var _0x5f0b92=fn[_0xf4d8('0xd')](_0x4b7a3c,_0x16ccf5);_0x212da5=null;return _0x317fd4;}}else{log[_0xf4d8('0x21')](_0xf4d8('0x1'));return _0x27a85d[_0xf4d8('0x96')](_0x5bb8fd);}}return _0x27a85d['LKNQR'](_0x5bb8fd,JSON[_0xf4d8('0x1b')](_0x4987a8));});}else{return{'_0xbeb667':0x0,'_0x5f4969':0x0,'_0x454851':0x0,'_0x3520c1':0x0};}});}};};