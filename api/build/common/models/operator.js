var _0x6d1a=['Y3JlYXRlVXNlcm5hbWU=','dG9TdHJpbmc=','aW5kZXhPZg==','YXBwbHk=','cmV0dXJuIChmdW5jdGlvbigpIA==','e30uY29uc3RydWN0b3IoInJldHVybiB0aGlzIikoICk=','Y29uc29sZQ==','bG9n','d2Fybg==','ZGVidWc=','aW5mbw==','ZXJyb3I=','ZXhjZXB0aW9u','dHJhY2U=','Li4vLi4vc2VydmVyL3NlcnZlcg==','Li4vLi4vc2VydmVyL21vZHVsZXMvdXRpbGl0eQ==','Y3JlYXRlTG9nZ2Vy','ZXhwb3J0cw==','b2JzZXJ2ZQ==','YWZ0ZXIgc2F2ZQ==','bW9kZWxz','Um9sZQ==','aXNOZXdJbnN0YW5jZQ==','aW5zdGFuY2U=','ZmluZE9uZQ==','T1BFUkFUT1I=','cHJpbmNpcGFscw==','Y3JlYXRl','VVNFUg==','YmVmb3JlIHNhdmU=','ZGF0YQ==','dXNlcm5hbWU=','ZW1haWw=','cGFzc3dvcmQ=','ZXh0cmFjdFVzZXJuYW1l','c3BsaXQ='];(function(_0x4127e4,_0x31c071){var _0x4d26d1=function(_0xd0f743){while(--_0xd0f743){_0x4127e4['push'](_0x4127e4['shift']());}};var _0x4aa3f6=function(){var _0x560f0a={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x506681,_0x234c73,_0x2bfd37,_0x127a04){_0x127a04=_0x127a04||{};var _0x3d567c=_0x234c73+'='+_0x2bfd37;var _0x34771b=0x0;for(var _0x34771b=0x0,_0x87cfb3=_0x506681['length'];_0x34771b<_0x87cfb3;_0x34771b++){var _0x3602ac=_0x506681[_0x34771b];_0x3d567c+=';\x20'+_0x3602ac;var _0x507408=_0x506681[_0x3602ac];_0x506681['push'](_0x507408);_0x87cfb3=_0x506681['length'];if(_0x507408!==!![]){_0x3d567c+='='+_0x507408;}}_0x127a04['cookie']=_0x3d567c;},'removeCookie':function(){return'dev';},'getCookie':function(_0x2de76c,_0x2a4a9b){_0x2de76c=_0x2de76c||function(_0x1f4786){return _0x1f4786;};var _0x4fe00d=_0x2de76c(new RegExp('(?:^|;\x20)'+_0x2a4a9b['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x492b85=function(_0x8ad6c,_0x4779c8){_0x8ad6c(++_0x4779c8);};_0x492b85(_0x4d26d1,_0x31c071);return _0x4fe00d?decodeURIComponent(_0x4fe00d[0x1]):undefined;}};var _0x21f9a9=function(){var _0x36090b=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x36090b['test'](_0x560f0a['removeCookie']['toString']());};_0x560f0a['updateCookie']=_0x21f9a9;var _0x1637cf='';var _0x5026d2=_0x560f0a['updateCookie']();if(!_0x5026d2){_0x560f0a['setCookie'](['*'],'counter',0x1);}else if(_0x5026d2){_0x1637cf=_0x560f0a['getCookie'](null,'counter');}else{_0x560f0a['removeCookie']();}};_0x4aa3f6();}(_0x6d1a,0xb7));var _0xa6d1=function(_0x183b97,_0x2d297c){_0x183b97=_0x183b97-0x0;var _0x629cf7=_0x6d1a[_0x183b97];if(_0xa6d1['initialized']===undefined){(function(){var _0x479999;try{var _0x330ba2=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x479999=_0x330ba2();}catch(_0x584824){_0x479999=window;}var _0x30c586='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x479999['atob']||(_0x479999['atob']=function(_0x41edf0){var _0x4878ce=String(_0x41edf0)['replace'](/=+$/,'');for(var _0x2df224=0x0,_0x345364,_0x248d7a,_0x4edbe5=0x0,_0x2fc94c='';_0x248d7a=_0x4878ce['charAt'](_0x4edbe5++);~_0x248d7a&&(_0x345364=_0x2df224%0x4?_0x345364*0x40+_0x248d7a:_0x248d7a,_0x2df224++%0x4)?_0x2fc94c+=String['fromCharCode'](0xff&_0x345364>>(-0x2*_0x2df224&0x6)):0x0){_0x248d7a=_0x30c586['indexOf'](_0x248d7a);}return _0x2fc94c;});}());_0xa6d1['base64DecodeUnicode']=function(_0x4957d7){var _0xfe1fd9=atob(_0x4957d7);var _0x5e5250=[];for(var _0x349fd2=0x0,_0x5b644c=_0xfe1fd9['length'];_0x349fd2<_0x5b644c;_0x349fd2++){_0x5e5250+='%'+('00'+_0xfe1fd9['charCodeAt'](_0x349fd2)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x5e5250);};_0xa6d1['data']={};_0xa6d1['initialized']=!![];}var _0x25818f=_0xa6d1['data'][_0x183b97];if(_0x25818f===undefined){var _0x5d84cb=function(_0xfb70da){this['rc4Bytes']=_0xfb70da;this['states']=[0x1,0x0,0x0];this['newState']=function(){return'newState';};this['firstState']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*';this['secondState']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x5d84cb['prototype']['checkState']=function(){var _0x4a5ecd=new RegExp(this['firstState']+this['secondState']);return this['runState'](_0x4a5ecd['test'](this['newState']['toString']())?--this['states'][0x1]:--this['states'][0x0]);};_0x5d84cb['prototype']['runState']=function(_0x401250){if(!Boolean(~_0x401250)){return _0x401250;}return this['getState'](this['rc4Bytes']);};_0x5d84cb['prototype']['getState']=function(_0x301e88){for(var _0xd2fd6=0x0,_0x107be5=this['states']['length'];_0xd2fd6<_0x107be5;_0xd2fd6++){this['states']['push'](Math['round'](Math['random']()));_0x107be5=this['states']['length'];}return _0x301e88(this['states'][0x0]);};new _0x5d84cb(_0xa6d1)['checkState']();_0x629cf7=_0xa6d1['base64DecodeUnicode'](_0x629cf7);_0xa6d1['data'][_0x183b97]=_0x629cf7;}else{_0x629cf7=_0x25818f;}return _0x629cf7;};var _0x4e56a9=function(){var _0x5cdb73=!![];return function(_0x27f966,_0x511377){var _0x1a33d0=_0x5cdb73?function(){if(_0x511377){var _0x3a1afb=_0x511377['apply'](_0x27f966,arguments);_0x511377=null;return _0x3a1afb;}}:function(){};_0x5cdb73=![];return _0x1a33d0;};}();var _0x4dbf41=_0x4e56a9(this,function(){var _0x3a3ce6=function(){return'\x64\x65\x76';},_0x35a11c=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x5eb2e8=function(){var _0x51dcf0=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x51dcf0['\x74\x65\x73\x74'](_0x3a3ce6['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x528e61=function(){var _0xdee0d3=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0xdee0d3['\x74\x65\x73\x74'](_0x35a11c['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x454d40=function(_0x3e0969){var _0x225717=~-0x1>>0x1+0xff%0x0;if(_0x3e0969['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x225717)){_0x62c03b(_0x3e0969);}};var _0x62c03b=function(_0x9f6c3a){var _0x57634b=~-0x4>>0x1+0xff%0x0;if(_0x9f6c3a['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x57634b){_0x454d40(_0x9f6c3a);}};if(!_0x5eb2e8()){if(!_0x528e61()){_0x454d40('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x454d40('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x454d40('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x4dbf41();var _0x3c8655=function(){var _0x5a8402=!![];return function(_0x45414b,_0x21a82e){var _0x1561b7=_0x5a8402?function(){if(_0x21a82e){var _0x16e7db=_0x21a82e[_0xa6d1('0x0')](_0x45414b,arguments);_0x21a82e=null;return _0x16e7db;}}:function(){};_0x5a8402=![];return _0x1561b7;};}();var _0x199ccc=_0x3c8655(this,function(){var _0x492e5e=function(){};var _0x451f8e;try{var _0x4301af=Function(_0xa6d1('0x1')+_0xa6d1('0x2')+');');_0x451f8e=_0x4301af();}catch(_0x83b61c){_0x451f8e=window;}if(!_0x451f8e[_0xa6d1('0x3')]){_0x451f8e[_0xa6d1('0x3')]=function(_0x1cbb24){var _0x2e262e={};_0x2e262e[_0xa6d1('0x4')]=_0x1cbb24;_0x2e262e[_0xa6d1('0x5')]=_0x1cbb24;_0x2e262e[_0xa6d1('0x6')]=_0x1cbb24;_0x2e262e[_0xa6d1('0x7')]=_0x1cbb24;_0x2e262e[_0xa6d1('0x8')]=_0x1cbb24;_0x2e262e[_0xa6d1('0x9')]=_0x1cbb24;_0x2e262e[_0xa6d1('0xa')]=_0x1cbb24;return _0x2e262e;}(_0x492e5e);}else{_0x451f8e[_0xa6d1('0x3')][_0xa6d1('0x4')]=_0x492e5e;_0x451f8e[_0xa6d1('0x3')][_0xa6d1('0x5')]=_0x492e5e;_0x451f8e[_0xa6d1('0x3')][_0xa6d1('0x6')]=_0x492e5e;_0x451f8e[_0xa6d1('0x3')][_0xa6d1('0x7')]=_0x492e5e;_0x451f8e[_0xa6d1('0x3')][_0xa6d1('0x8')]=_0x492e5e;_0x451f8e[_0xa6d1('0x3')][_0xa6d1('0x9')]=_0x492e5e;_0x451f8e[_0xa6d1('0x3')][_0xa6d1('0xa')]=_0x492e5e;}});_0x199ccc();'use strict';var logger=require('../../server/modules/logger');var app=require(_0xa6d1('0xb'));var config=require('../../server/modules/config');var utility=require(_0xa6d1('0xc'));var Payment=require('../../server/modules/payment');var request=require('request');var Q=require('q');const uuid=require('uuid');const log=logger[_0xa6d1('0xd')]();module[_0xa6d1('0xe')]=function(_0x12e9a8){_0x12e9a8[_0xa6d1('0xf')](_0xa6d1('0x10'),async _0x5c259e=>{var _0x2b4e6f=app[_0xa6d1('0x11')][_0xa6d1('0x12')];if(_0x5c259e[_0xa6d1('0x13')]){var _0x25f359=_0x5c259e[_0xa6d1('0x14')]['id'];const _0x5b27d2=await _0x2b4e6f[_0xa6d1('0x15')]({'where':{'name':config['ROLES'][_0xa6d1('0x16')]}});log['error']({'role':_0x5b27d2});await _0x5b27d2[_0xa6d1('0x17')][_0xa6d1('0x18')]({'principalType':_0xa6d1('0x19'),'principalId':_0x25f359});}});_0x12e9a8[_0xa6d1('0xf')](_0xa6d1('0x1a'),async _0x3c44bf=>{let _0x3be174;if(_0x3c44bf[_0xa6d1('0x14')]){_0x3be174=_0x3c44bf['instance'];}else if(_0x3c44bf[_0xa6d1('0x1b')]){_0x3be174=_0x3c44bf[_0xa6d1('0x1b')];}if(_0x3be174){_0x3be174[_0xa6d1('0x1c')]=_0x12e9a8['createUsername'](_0x3be174['businessId'],_0x3be174[_0xa6d1('0x1c')]);_0x3be174[_0xa6d1('0x1d')]=_0x3be174['username'];if(!_0x3be174[_0xa6d1('0x1e')]){_0x3be174['password']=uuid['v4']();}}});_0x12e9a8[_0xa6d1('0x1f')]=function(_0x331b3d){if(!_0x331b3d){return null;}return _0x331b3d[_0xa6d1('0x20')]('@')[0x0];};_0x12e9a8[_0xa6d1('0x21')]=function(_0x31ee5d,_0x23cf15){if(!_0x23cf15||!_0x31ee5d){return null;}_0x23cf15=_0x23cf15[_0xa6d1('0x22')]();if(_0x23cf15[_0xa6d1('0x23')]('@')!=-0x1){return _0x23cf15;}return _0x23cf15+'@'+_0x31ee5d;};};