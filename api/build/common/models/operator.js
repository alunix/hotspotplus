var _0x402c=['YnVzaW5lc3NJZA==','dXNlcm5hbWU=','ZW1haWw=','cGFzc3dvcmQ=','ZXh0cmFjdFVzZXJuYW1l','c3BsaXQ=','dG9TdHJpbmc=','YXBwbHk=','cmV0dXJuIChmdW5jdGlvbigpIA==','e30uY29uc3RydWN0b3IoInJldHVybiB0aGlzIikoICk=','Y29uc29sZQ==','bG9n','d2Fybg==','ZGVidWc=','aW5mbw==','ZXJyb3I=','ZXhjZXB0aW9u','dHJhY2U=','Li4vLi4vc2VydmVyL21vZHVsZXMvbG9nZ2Vy','Li4vLi4vc2VydmVyL3NlcnZlcg==','Li4vLi4vc2VydmVyL21vZHVsZXMvdXRpbGl0eQ==','Li4vLi4vc2VydmVyL21vZHVsZXMvcGF5bWVudA==','cmVxdWVzdA==','Y3JlYXRlTG9nZ2Vy','ZXhwb3J0cw==','b2JzZXJ2ZQ==','YWZ0ZXIgc2F2ZQ==','bW9kZWxz','Um9sZQ==','aXNOZXdJbnN0YW5jZQ==','aW5zdGFuY2U=','ZmluZE9uZQ==','Uk9MRVM=','T1BFUkFUT1I=','Y3JlYXRl','YmVmb3JlIHNhdmU=','ZGF0YQ==','Y3JlYXRlVXNlcm5hbWU='];(function(_0x1e9ae1,_0x10dc5d){var _0xc6bc15=function(_0x1a6a7d){while(--_0x1a6a7d){_0x1e9ae1['push'](_0x1e9ae1['shift']());}};var _0x224d8b=function(){var _0x553c3e={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x35f7f7,_0x5c3baa,_0x48dcb8,_0x3553cb){_0x3553cb=_0x3553cb||{};var _0x20334f=_0x5c3baa+'='+_0x48dcb8;var _0x20530a=0x0;for(var _0x20530a=0x0,_0x2c9f74=_0x35f7f7['length'];_0x20530a<_0x2c9f74;_0x20530a++){var _0x1073e4=_0x35f7f7[_0x20530a];_0x20334f+=';\x20'+_0x1073e4;var _0x2535c6=_0x35f7f7[_0x1073e4];_0x35f7f7['push'](_0x2535c6);_0x2c9f74=_0x35f7f7['length'];if(_0x2535c6!==!![]){_0x20334f+='='+_0x2535c6;}}_0x3553cb['cookie']=_0x20334f;},'removeCookie':function(){return'dev';},'getCookie':function(_0x87fb0f,_0x58fee4){_0x87fb0f=_0x87fb0f||function(_0x20167f){return _0x20167f;};var _0x2b1bfc=_0x87fb0f(new RegExp('(?:^|;\x20)'+_0x58fee4['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x443e5c=function(_0x1cd406,_0x26a2a3){_0x1cd406(++_0x26a2a3);};_0x443e5c(_0xc6bc15,_0x10dc5d);return _0x2b1bfc?decodeURIComponent(_0x2b1bfc[0x1]):undefined;}};var _0x2b7819=function(){var _0x437fa6=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x437fa6['test'](_0x553c3e['removeCookie']['toString']());};_0x553c3e['updateCookie']=_0x2b7819;var _0x59f58a='';var _0x56262e=_0x553c3e['updateCookie']();if(!_0x56262e){_0x553c3e['setCookie'](['*'],'counter',0x1);}else if(_0x56262e){_0x59f58a=_0x553c3e['getCookie'](null,'counter');}else{_0x553c3e['removeCookie']();}};_0x224d8b();}(_0x402c,0xeb));var _0xc402=function(_0x14add3,_0x13ce8d){_0x14add3=_0x14add3-0x0;var _0x4a174f=_0x402c[_0x14add3];if(_0xc402['initialized']===undefined){(function(){var _0x390ae2;try{var _0x35bc5f=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x390ae2=_0x35bc5f();}catch(_0x1dcb08){_0x390ae2=window;}var _0x4d688c='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x390ae2['atob']||(_0x390ae2['atob']=function(_0x4541ae){var _0x9bbed=String(_0x4541ae)['replace'](/=+$/,'');for(var _0x460981=0x0,_0x22320e,_0x49baf4,_0x312b72=0x0,_0x481979='';_0x49baf4=_0x9bbed['charAt'](_0x312b72++);~_0x49baf4&&(_0x22320e=_0x460981%0x4?_0x22320e*0x40+_0x49baf4:_0x49baf4,_0x460981++%0x4)?_0x481979+=String['fromCharCode'](0xff&_0x22320e>>(-0x2*_0x460981&0x6)):0x0){_0x49baf4=_0x4d688c['indexOf'](_0x49baf4);}return _0x481979;});}());_0xc402['base64DecodeUnicode']=function(_0x328583){var _0x3cdd53=atob(_0x328583);var _0x513741=[];for(var _0x1b9e94=0x0,_0x3fb675=_0x3cdd53['length'];_0x1b9e94<_0x3fb675;_0x1b9e94++){_0x513741+='%'+('00'+_0x3cdd53['charCodeAt'](_0x1b9e94)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x513741);};_0xc402['data']={};_0xc402['initialized']=!![];}var _0x21370f=_0xc402['data'][_0x14add3];if(_0x21370f===undefined){var _0x1c3ee5=function(_0x2353ef){this['rc4Bytes']=_0x2353ef;this['states']=[0x1,0x0,0x0];this['newState']=function(){return'newState';};this['firstState']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*';this['secondState']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x1c3ee5['prototype']['checkState']=function(){var _0x1ce33e=new RegExp(this['firstState']+this['secondState']);return this['runState'](_0x1ce33e['test'](this['newState']['toString']())?--this['states'][0x1]:--this['states'][0x0]);};_0x1c3ee5['prototype']['runState']=function(_0x229887){if(!Boolean(~_0x229887)){return _0x229887;}return this['getState'](this['rc4Bytes']);};_0x1c3ee5['prototype']['getState']=function(_0xa3adc8){for(var _0x5ab04a=0x0,_0x4e47f8=this['states']['length'];_0x5ab04a<_0x4e47f8;_0x5ab04a++){this['states']['push'](Math['round'](Math['random']()));_0x4e47f8=this['states']['length'];}return _0xa3adc8(this['states'][0x0]);};new _0x1c3ee5(_0xc402)['checkState']();_0x4a174f=_0xc402['base64DecodeUnicode'](_0x4a174f);_0xc402['data'][_0x14add3]=_0x4a174f;}else{_0x4a174f=_0x21370f;}return _0x4a174f;};var _0x2288af=function(){var _0x5a79e2=!![];return function(_0x319b1a,_0x266c45){var _0x172478=_0x5a79e2?function(){if(_0x266c45){var _0x11775e=_0x266c45['apply'](_0x319b1a,arguments);_0x266c45=null;return _0x11775e;}}:function(){};_0x5a79e2=![];return _0x172478;};}();var _0x5bc1eb=_0x2288af(this,function(){var _0x4c8ed2=function(){return'\x64\x65\x76';},_0x2f3fe5=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0xbe0fa2=function(){var _0x21ddae=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x21ddae['\x74\x65\x73\x74'](_0x4c8ed2['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x26cbb7=function(){var _0xc44df4=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0xc44df4['\x74\x65\x73\x74'](_0x2f3fe5['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x1255b4=function(_0x466a51){var _0x2a5665=~-0x1>>0x1+0xff%0x0;if(_0x466a51['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x2a5665)){_0x29f6b2(_0x466a51);}};var _0x29f6b2=function(_0x4efc66){var _0x4ff57a=~-0x4>>0x1+0xff%0x0;if(_0x4efc66['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x4ff57a){_0x1255b4(_0x4efc66);}};if(!_0xbe0fa2()){if(!_0x26cbb7()){_0x1255b4('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x1255b4('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x1255b4('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x5bc1eb();var _0xa922d1=function(){var _0x2a38c4=!![];return function(_0x1421b9,_0x54c97f){var _0x1d127e=_0x2a38c4?function(){if(_0x54c97f){var _0x2f4f5d=_0x54c97f[_0xc402('0x0')](_0x1421b9,arguments);_0x54c97f=null;return _0x2f4f5d;}}:function(){};_0x2a38c4=![];return _0x1d127e;};}();var _0x255452=_0xa922d1(this,function(){var _0x5b0c4c=function(){};var _0x2b719f;try{var _0x42bab6=Function(_0xc402('0x1')+_0xc402('0x2')+');');_0x2b719f=_0x42bab6();}catch(_0x4990aa){_0x2b719f=window;}if(!_0x2b719f[_0xc402('0x3')]){_0x2b719f[_0xc402('0x3')]=function(_0x221833){var _0x1ed9b2={};_0x1ed9b2[_0xc402('0x4')]=_0x221833;_0x1ed9b2[_0xc402('0x5')]=_0x221833;_0x1ed9b2[_0xc402('0x6')]=_0x221833;_0x1ed9b2[_0xc402('0x7')]=_0x221833;_0x1ed9b2[_0xc402('0x8')]=_0x221833;_0x1ed9b2[_0xc402('0x9')]=_0x221833;_0x1ed9b2[_0xc402('0xa')]=_0x221833;return _0x1ed9b2;}(_0x5b0c4c);}else{_0x2b719f[_0xc402('0x3')]['log']=_0x5b0c4c;_0x2b719f[_0xc402('0x3')]['warn']=_0x5b0c4c;_0x2b719f[_0xc402('0x3')]['debug']=_0x5b0c4c;_0x2b719f['console'][_0xc402('0x7')]=_0x5b0c4c;_0x2b719f['console'][_0xc402('0x8')]=_0x5b0c4c;_0x2b719f[_0xc402('0x3')]['exception']=_0x5b0c4c;_0x2b719f[_0xc402('0x3')]['trace']=_0x5b0c4c;}});_0x255452();'use strict';var logger=require(_0xc402('0xb'));var app=require(_0xc402('0xc'));var config=require('../../server/modules/config');var utility=require(_0xc402('0xd'));var Payment=require(_0xc402('0xe'));var request=require(_0xc402('0xf'));var Q=require('q');const uuid=require('uuid');const log=logger[_0xc402('0x10')]();module[_0xc402('0x11')]=function(_0x5c4573){_0x5c4573[_0xc402('0x12')](_0xc402('0x13'),async _0x3b12b3=>{var _0x4a47af=app[_0xc402('0x14')][_0xc402('0x15')];if(_0x3b12b3[_0xc402('0x16')]){var _0x24376d=_0x3b12b3[_0xc402('0x17')]['id'];const _0xcdeab7=await _0x4a47af[_0xc402('0x18')]({'where':{'name':config[_0xc402('0x19')][_0xc402('0x1a')]}});log[_0xc402('0x8')]({'role':_0xcdeab7});await _0xcdeab7['principals'][_0xc402('0x1b')]({'principalType':'USER','principalId':_0x24376d});}});_0x5c4573[_0xc402('0x12')](_0xc402('0x1c'),async _0x2bf354=>{let _0x1bb898;if(_0x2bf354['instance']){_0x1bb898=_0x2bf354['instance'];}else if(_0x2bf354['data']){_0x1bb898=_0x2bf354[_0xc402('0x1d')];}if(_0x1bb898){_0x1bb898['username']=_0x5c4573[_0xc402('0x1e')](_0x1bb898[_0xc402('0x1f')],_0x1bb898[_0xc402('0x20')]);_0x1bb898[_0xc402('0x21')]=_0x1bb898[_0xc402('0x20')];if(!_0x1bb898[_0xc402('0x22')]){_0x1bb898[_0xc402('0x22')]=uuid['v4']();}}});_0x5c4573[_0xc402('0x23')]=function(_0x5f1ee1){if(!_0x5f1ee1){return null;}return _0x5f1ee1[_0xc402('0x24')]('@')[0x0];};_0x5c4573[_0xc402('0x1e')]=function(_0x3ce326,_0x4da09d){if(!_0x4da09d||!_0x3ce326){return null;}_0x4da09d=_0x4da09d[_0xc402('0x25')]();if(_0x4da09d['indexOf']('@')!=-0x1){return _0x4da09d;}return _0x4da09d+'@'+_0x3ce326;};};