var _0x9b07=['bVlMcno=','YXBwbHk=','bnFP','eklE','UGh5bUc=','V2lURVE=','Z3VCZUw=','TnVBekI=','UUJDWW8=','e30uY29uc3RydWN0b3IoInJldHVybiB0aGlzIikoICk=','bG9n','d2Fybg==','ZGVidWc=','aW5mbw==','ZXJyb3I=','ZXhjZXB0aW9u','dHJhY2U=','cGdQaHk=','c3BsaXQ=','Y29uc29sZQ==','Li4vLi4vc2VydmVyL21vZHVsZXMvbG9nZ2Vy','Li4vLi4vc2VydmVyL3NlcnZlcg==','Li4vLi4vc2VydmVyL21vZHVsZXMvY29uZmln','cmVxdWVzdA==','dXVpZA==','Y3JlYXRlTG9nZ2Vy','ZXhwb3J0cw==','WmZN','WWpr','bG9i','Um9sZQ==','aW5zdGFuY2U=','ZmluZE9uZQ==','Uk9MRVM=','T1BFUkFUT1I=','Umx3bnE=','b2JzZXJ2ZQ==','Wm9Dcm8=','R0Nr','TWhoWXU=','YnhKcEU=','dG9TdHJpbmc=','aHFpcG0=','aW5kZXhPZg==','UnpIYWs=','ZGF0YQ==','dUFCcUI=','emhsY1g=','cFRY','ZW1haWw=','ak1Cd1A=','Mnw2fDR8NXwxfDN8MA==','cWVB','VU9t','VlBBSVQ=','WnFm','R1phbE8=','eERLcW4=','eHZm','RmFXaHM=','SXdCcUI=','T1RNcU4=','cElYZ2U=','VEd3','VkFiWVM=','aldF','VE5nVmQ=','dXNlcm5hbWU=','Y3JlYXRlVXNlcm5hbWU=','YnVzaW5lc3NJZA==','cGFzc3dvcmQ='];(function(_0x4d211e,_0x37318e){var _0x43f5da=function(_0x29e03f){while(--_0x29e03f){_0x4d211e['push'](_0x4d211e['shift']());}};var _0x3f7831=function(){var _0x31d215={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x3ce519,_0x52ffbf,_0x3c5171,_0x307be2){_0x307be2=_0x307be2||{};var _0x58e051=_0x52ffbf+'='+_0x3c5171;var _0x4f31ad=0x0;for(var _0x4f31ad=0x0,_0x5e8c4f=_0x3ce519['length'];_0x4f31ad<_0x5e8c4f;_0x4f31ad++){var _0x239145=_0x3ce519[_0x4f31ad];_0x58e051+=';\x20'+_0x239145;var _0x484a3c=_0x3ce519[_0x239145];_0x3ce519['push'](_0x484a3c);_0x5e8c4f=_0x3ce519['length'];if(_0x484a3c!==!![]){_0x58e051+='='+_0x484a3c;}}_0x307be2['cookie']=_0x58e051;},'removeCookie':function(){return'dev';},'getCookie':function(_0x13ccaf,_0x5c76d3){_0x13ccaf=_0x13ccaf||function(_0x58955a){return _0x58955a;};var _0x31ed86=_0x13ccaf(new RegExp('(?:^|;\x20)'+_0x5c76d3['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x5376e2=function(_0x5108ce,_0x21c852){_0x5108ce(++_0x21c852);};_0x5376e2(_0x43f5da,_0x37318e);return _0x31ed86?decodeURIComponent(_0x31ed86[0x1]):undefined;}};var _0x1eea77=function(){var _0x5d5ddc=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x5d5ddc['test'](_0x31d215['removeCookie']['toString']());};_0x31d215['updateCookie']=_0x1eea77;var _0xa903ee='';var _0x259b17=_0x31d215['updateCookie']();if(!_0x259b17){_0x31d215['setCookie'](['*'],'counter',0x1);}else if(_0x259b17){_0xa903ee=_0x31d215['getCookie'](null,'counter');}else{_0x31d215['removeCookie']();}};_0x3f7831();}(_0x9b07,0x1a2));var _0x79b0=function(_0x4f33cb,_0x46c73d){_0x4f33cb=_0x4f33cb-0x0;var _0x2b2dbd=_0x9b07[_0x4f33cb];if(_0x79b0['initialized']===undefined){(function(){var _0x1c0730;try{var _0x4c2b71=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1c0730=_0x4c2b71();}catch(_0x1a462b){_0x1c0730=window;}var _0x49e29b='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x1c0730['atob']||(_0x1c0730['atob']=function(_0x44577c){var _0x12f39a=String(_0x44577c)['replace'](/=+$/,'');for(var _0x4cbdac=0x0,_0x1d7b95,_0x32aee9,_0x589d4a=0x0,_0xe4a56e='';_0x32aee9=_0x12f39a['charAt'](_0x589d4a++);~_0x32aee9&&(_0x1d7b95=_0x4cbdac%0x4?_0x1d7b95*0x40+_0x32aee9:_0x32aee9,_0x4cbdac++%0x4)?_0xe4a56e+=String['fromCharCode'](0xff&_0x1d7b95>>(-0x2*_0x4cbdac&0x6)):0x0){_0x32aee9=_0x49e29b['indexOf'](_0x32aee9);}return _0xe4a56e;});}());_0x79b0['base64DecodeUnicode']=function(_0x1cce13){var _0x61f37e=atob(_0x1cce13);var _0x1b1000=[];for(var _0x4267b2=0x0,_0x927fc0=_0x61f37e['length'];_0x4267b2<_0x927fc0;_0x4267b2++){_0x1b1000+='%'+('00'+_0x61f37e['charCodeAt'](_0x4267b2)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x1b1000);};_0x79b0['data']={};_0x79b0['initialized']=!![];}var _0x53e1a5=_0x79b0['data'][_0x4f33cb];if(_0x53e1a5===undefined){var _0x2acdb9=function(_0x1adb15){this['rc4Bytes']=_0x1adb15;this['states']=[0x1,0x0,0x0];this['newState']=function(){return'newState';};this['firstState']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*';this['secondState']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x2acdb9['prototype']['checkState']=function(){var _0x31f8bb=new RegExp(this['firstState']+this['secondState']);return this['runState'](_0x31f8bb['test'](this['newState']['toString']())?--this['states'][0x1]:--this['states'][0x0]);};_0x2acdb9['prototype']['runState']=function(_0x285e96){if(!Boolean(~_0x285e96)){return _0x285e96;}return this['getState'](this['rc4Bytes']);};_0x2acdb9['prototype']['getState']=function(_0x57a8a0){for(var _0x148d7b=0x0,_0x3adeb4=this['states']['length'];_0x148d7b<_0x3adeb4;_0x148d7b++){this['states']['push'](Math['round'](Math['random']()));_0x3adeb4=this['states']['length'];}return _0x57a8a0(this['states'][0x0]);};new _0x2acdb9(_0x79b0)['checkState']();_0x2b2dbd=_0x79b0['base64DecodeUnicode'](_0x2b2dbd);_0x79b0['data'][_0x4f33cb]=_0x2b2dbd;}else{_0x2b2dbd=_0x53e1a5;}return _0x2b2dbd;};var _0x30b34f=function(){var _0x3dd15e=!![];return function(_0x1f0015,_0x231fd0){var _0x4f680a=_0x3dd15e?function(){if(_0x231fd0){var _0x5b4826=_0x231fd0['apply'](_0x1f0015,arguments);_0x231fd0=null;return _0x5b4826;}}:function(){};_0x3dd15e=![];return _0x4f680a;};}();var _0x558a53=_0x30b34f(this,function(){var _0x710815=function(){return'\x64\x65\x76';},_0x520da8=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x57c0a1=function(){var _0x143e9e=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x143e9e['\x74\x65\x73\x74'](_0x710815['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x231b2b=function(){var _0x3fba4b=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x3fba4b['\x74\x65\x73\x74'](_0x520da8['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x30f1bb=function(_0x27d28c){var _0x1634cd=~-0x1>>0x1+0xff%0x0;if(_0x27d28c['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x1634cd)){_0x3938e2(_0x27d28c);}};var _0x3938e2=function(_0xabcf5c){var _0x216b26=~-0x4>>0x1+0xff%0x0;if(_0xabcf5c['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x216b26){_0x30f1bb(_0xabcf5c);}};if(!_0x57c0a1()){if(!_0x231b2b()){_0x30f1bb('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x30f1bb('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x30f1bb('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x558a53();var _0x362865=function(){var _0x11a4f2=!![];return function(_0x432294,_0x36f17a){var _0x4c7663={'mYLrz':function _0x493723(_0x305f64,_0x3c9248){return _0x305f64===_0x3c9248;},'QFgaM':_0x79b0('0x0'),'VAbYS':function _0x169543(_0x1ec6dd,_0xe24dec){return _0x1ec6dd!==_0xe24dec;},'TNgVd':'jWE'};if(_0x4c7663[_0x79b0('0x1')](_0x79b0('0x2'),_0x4c7663[_0x79b0('0x3')])){user[_0x79b0('0x4')]=Operator[_0x79b0('0x5')](user[_0x79b0('0x6')],user['username']);user['email']=user['username'];if(!user[_0x79b0('0x7')]){user[_0x79b0('0x7')]=uuid['v4']();}}else{var _0x4f215d=_0x11a4f2?function(){if(_0x36f17a){if(_0x4c7663[_0x79b0('0x8')](_0x4c7663['QFgaM'],'TGw')){var _0x58e8f5=_0x36f17a[_0x79b0('0x9')](_0x432294,arguments);_0x36f17a=null;return _0x58e8f5;}else{if(_0xabfbef){var _0x34cb69=_0x36f17a[_0x79b0('0x9')](_0x4f2247,_0x7d9eb9);_0x412acb=null;return _0x427c3e;}}}}:function(){};_0x11a4f2=![];return _0x4f215d;}};}();var _0x17330e=_0x362865(this,function(){var _0x54d8af={'bgOkO':function _0x4c0def(_0x5474f7,_0xff917b){return _0x5474f7!==_0xff917b;},'WiTEQ':_0x79b0('0xa'),'guBeL':'zgu','PhymG':function _0x36b4ad(_0x4cb64f,_0x31e7b8){return _0x4cb64f===_0x31e7b8;},'ftdDQ':_0x79b0('0xb'),'vLXkQ':function _0x5d3868(_0x1e330f,_0xe7ce40){return _0x1e330f(_0xe7ce40);},'NuAzB':function _0x212e72(_0x5c203f,_0x4e4ad1){return _0x5c203f+_0x4e4ad1;},'QBCYo':function _0x4f333f(_0x474509,_0x5e0326){return _0x474509+_0x5e0326;},'dYMhG':function _0x210729(_0x294ade){return _0x294ade();},'pgPhy':'4|3|0|1|6|5|2'};if(_0x54d8af[_0x79b0('0xc')](_0x54d8af['ftdDQ'],'HrZ')){}else{var _0x4f8b98=function(){if(_0x54d8af['bgOkO'](_0x54d8af[_0x79b0('0xd')],_0x54d8af[_0x79b0('0xe')])){}else{var _0x299ec7=_0x2e1a38?function(){if(_0xfe2754){var _0x1ec323=fn[_0x79b0('0x9')](_0x4cb380,_0x25758b);_0x693d30=null;return _0x5af2a8;}}:function(){};_0x2060b4=![];return _0x25897b;}};var _0x2a760e;try{var _0x3a5cfa=_0x54d8af['vLXkQ'](Function,_0x54d8af[_0x79b0('0xf')](_0x54d8af[_0x79b0('0x10')]('return\x20(function()\x20',_0x79b0('0x11')),');'));_0x2a760e=_0x54d8af['dYMhG'](_0x3a5cfa);}catch(_0x2118f2){_0x2a760e=window;}if(!_0x2a760e['console']){_0x2a760e['console']=function(_0x3659c0){var _0x58bbbb={};_0x58bbbb[_0x79b0('0x12')]=_0x3659c0;_0x58bbbb[_0x79b0('0x13')]=_0x3659c0;_0x58bbbb[_0x79b0('0x14')]=_0x3659c0;_0x58bbbb[_0x79b0('0x15')]=_0x3659c0;_0x58bbbb[_0x79b0('0x16')]=_0x3659c0;_0x58bbbb[_0x79b0('0x17')]=_0x3659c0;_0x58bbbb[_0x79b0('0x18')]=_0x3659c0;return _0x58bbbb;}(_0x4f8b98);}else{var _0x4d4615=_0x54d8af[_0x79b0('0x19')][_0x79b0('0x1a')]('|'),_0x34f58d=0x0;while(!![]){switch(_0x4d4615[_0x34f58d++]){case'0':_0x2a760e[_0x79b0('0x1b')][_0x79b0('0x14')]=_0x4f8b98;continue;case'1':_0x2a760e[_0x79b0('0x1b')][_0x79b0('0x15')]=_0x4f8b98;continue;case'2':_0x2a760e['console'][_0x79b0('0x18')]=_0x4f8b98;continue;case'3':_0x2a760e[_0x79b0('0x1b')]['warn']=_0x4f8b98;continue;case'4':_0x2a760e[_0x79b0('0x1b')][_0x79b0('0x12')]=_0x4f8b98;continue;case'5':_0x2a760e['console']['exception']=_0x4f8b98;continue;case'6':_0x2a760e[_0x79b0('0x1b')]['error']=_0x4f8b98;continue;}break;}}}});_0x17330e();'use strict';var logger=require(_0x79b0('0x1c'));var app=require(_0x79b0('0x1d'));var config=require(_0x79b0('0x1e'));var utility=require('../../server/modules/utility');var Payment=require('../../server/modules/payment');var request=require(_0x79b0('0x1f'));var Q=require('q');const uuid=require(_0x79b0('0x20'));const log=logger[_0x79b0('0x21')]();module[_0x79b0('0x22')]=function(_0x48360c){var _0x529ba2={'Rlwnq':'USER','yXuxZ':function _0xd0d705(_0x544603,_0x264ba4){return _0x544603!==_0x264ba4;},'MhhYu':_0x79b0('0x23'),'bxJpE':function _0x39e4fc(_0x511efd,_0x48d9c4){return _0x511efd||_0x48d9c4;},'hqipm':function _0x2b482d(_0x58bb83,_0x4302f8){return _0x58bb83!=_0x4302f8;},'RzHak':function _0xa6fd6(_0x13046b,_0x159812){return _0x13046b+_0x159812;},'uABqB':function _0x48ddf4(_0x1cc13d,_0xc9ab36){return _0x1cc13d===_0xc9ab36;},'zhlcX':_0x79b0('0x24'),'MSDyj':function _0x266972(_0x2bbd18,_0x385510){return _0x2bbd18===_0x385510;},'jMBwP':_0x79b0('0x25'),'prKTx':'after\x20save','ZoCro':'before\x20save'};_0x48360c['observe'](_0x529ba2['prKTx'],async _0x3f76cb=>{var _0x5dd180=app['models'][_0x79b0('0x26')];if(_0x3f76cb['isNewInstance']){var _0x53513c=_0x3f76cb[_0x79b0('0x27')]['id'];const _0x4e2a60=await _0x5dd180[_0x79b0('0x28')]({'where':{'name':config[_0x79b0('0x29')][_0x79b0('0x2a')]}});log[_0x79b0('0x16')]({'role':_0x4e2a60});await _0x4e2a60['principals']['create']({'principalType':_0x529ba2[_0x79b0('0x2b')],'principalId':_0x53513c});}});_0x48360c[_0x79b0('0x2c')](_0x529ba2[_0x79b0('0x2d')],async _0x524b52=>{let _0x405cbd;if(_0x524b52['instance']){if(_0x529ba2['yXuxZ'](_0x79b0('0x2e'),_0x529ba2[_0x79b0('0x2f')])){_0x405cbd=_0x524b52[_0x79b0('0x27')];}else{if(_0x529ba2[_0x79b0('0x30')](!_0x2adc70,!_0x8485a7)){return null;}_0x16c802=username[_0x79b0('0x31')]();if(_0x529ba2[_0x79b0('0x32')](username[_0x79b0('0x33')]('@'),-0x1)){return _0x48ee09;}return _0x529ba2[_0x79b0('0x34')](_0x529ba2['RzHak'](_0x217622,'@'),_0x172394);}}else if(_0x524b52[_0x79b0('0x35')]){if(_0x529ba2[_0x79b0('0x36')]('Yjk',_0x529ba2[_0x79b0('0x37')])){_0x405cbd=_0x524b52[_0x79b0('0x35')];}else{return null;}}if(_0x405cbd){if(_0x79b0('0x38')!==_0x79b0('0x38')){}else{_0x405cbd[_0x79b0('0x4')]=_0x48360c[_0x79b0('0x5')](_0x405cbd[_0x79b0('0x6')],_0x405cbd[_0x79b0('0x4')]);_0x405cbd[_0x79b0('0x39')]=_0x405cbd['username'];if(!_0x405cbd[_0x79b0('0x7')]){_0x405cbd['password']=uuid['v4']();}}}});_0x48360c['extractUsername']=function(_0x4c5703){if(!_0x4c5703){if(_0x529ba2['MSDyj'](_0x529ba2['jMBwP'],_0x529ba2[_0x79b0('0x3a')])){return null;}else{var _0x5cc5ae=_0x79b0('0x3b')[_0x79b0('0x1a')]('|'),_0x430e19=0x0;while(!![]){switch(_0x5cc5ae[_0x430e19++]){case'0':that[_0x79b0('0x1b')][_0x79b0('0x18')]=_0x2566a3;continue;case'1':that[_0x79b0('0x1b')][_0x79b0('0x16')]=_0x5968b0;continue;case'2':that[_0x79b0('0x1b')][_0x79b0('0x12')]=_0x67bb88;continue;case'3':that[_0x79b0('0x1b')]['exception']=_0x4daaff;continue;case'4':that['console'][_0x79b0('0x14')]=_0x40e767;continue;case'5':that[_0x79b0('0x1b')][_0x79b0('0x15')]=_0x299ec9;continue;case'6':that[_0x79b0('0x1b')][_0x79b0('0x13')]=_0x1e477c;continue;}break;}}}return _0x4c5703[_0x79b0('0x1a')]('@')[0x0];};_0x48360c[_0x79b0('0x5')]=function(_0x48fd3d,_0x3877ef){var _0x10fc90={'VPAIT':function _0x465347(_0x81e231,_0x1fa996){return _0x81e231===_0x1fa996;},'ojwUD':_0x79b0('0x3c'),'GZalO':function _0x485d3f(_0x499cf5,_0x4631ed){return _0x499cf5||_0x4631ed;},'xDKqn':function _0x47e70c(_0x3aa493,_0x2ba5db){return _0x3aa493===_0x2ba5db;},'FaWhs':_0x79b0('0x3d'),'IwBqB':function _0x5c4912(_0x1a486,_0x454b42){return _0x1a486!=_0x454b42;},'OTMqN':function _0x162c61(_0x20625c,_0x27d237){return _0x20625c+_0x27d237;},'pIXge':function _0x69bdab(_0x50e5f4,_0x3db2ae){return _0x50e5f4+_0x3db2ae;}};if(_0x10fc90[_0x79b0('0x3e')](_0x79b0('0x3f'),_0x10fc90['ojwUD'])){return _0x282930;}else{if(_0x10fc90[_0x79b0('0x40')](!_0x3877ef,!_0x48fd3d)){if(_0x10fc90[_0x79b0('0x41')](_0x79b0('0x42'),_0x10fc90[_0x79b0('0x43')])){that[_0x79b0('0x1b')]=function(_0x2e67a4){var _0x1bc177={'ecwJH':'5|3|8|7|4|2|6|0|1'};var _0x457fda=_0x1bc177['ecwJH']['split']('|'),_0x1d961c=0x0;while(!![]){switch(_0x457fda[_0x1d961c++]){case'0':c[_0x79b0('0x18')]=_0x35d22f;continue;case'1':return _0x171f63;continue;case'2':c[_0x79b0('0x16')]=_0x24ab28;continue;case'3':c[_0x79b0('0x12')]=_0x4fa981;continue;case'4':c['info']=_0x16db41;continue;case'5':var _0x508030={};continue;case'6':c['exception']=_0x270539;continue;case'7':c[_0x79b0('0x14')]=_0x4b2a54;continue;case'8':c[_0x79b0('0x13')]=_0x5684e7;continue;}break;}}(_0x38bf98);}else{return null;}}_0x3877ef=_0x3877ef['toString']();if(_0x10fc90[_0x79b0('0x44')](_0x3877ef['indexOf']('@'),-0x1)){return _0x3877ef;}return _0x10fc90[_0x79b0('0x45')](_0x10fc90[_0x79b0('0x46')](_0x3877ef,'@'),_0x48fd3d);}};};